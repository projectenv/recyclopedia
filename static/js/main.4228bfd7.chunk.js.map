{"version":3,"sources":["secrets.js","utils/RecyclopediaApplicationContext.js","hooks/useLocalStorageState.js","utils/functions.js","utils/intoParsable.js","utils/preprocessMarkdown.js","components/Article/RenderMarkdown.jsx","components/Form/Input.jsx","components/Form/Form.jsx","components/Form/Button.jsx","pages/Admin/MediaPreview.jsx","pages/Admin/Editors/MarkdownEditor.jsx","utils/DOMIntoMarkdown.js","pages/Admin/Editors/RichTextEditor.jsx","pages/Admin/Admin.jsx","components/Article/Article.jsx","pages/Header/Header.jsx","components/Searchbar/Searchbar.jsx","pages/Homepage/Homepage.jsx","utils/search.js","App.jsx","index.jsx","components/Form/Input.module.scss","pages/Admin/Editors/NoticeBanner.module.scss","pages/Header/Header.module.scss","components/Searchbar/Searchbar.module.scss","App.module.scss","components/Article/Article.module.scss","components/Form/Button.module.scss"],"names":["Secrets","RecyclopediaApplicationContext","appId","onFinishedLoadFn","recyclopediaAnonymousCredentials","Realm","anonymous","this","application","id","applicationUser","undefined","a","logIn","result","bind","console","error","query","functions","getAllArticles","name","removeArticle","articleContents","createOrUpdateArticle","useLocalStorageState","itemName","initialValue","useState","item","localStorage","getItem","JSON","parse","err","state","setState","value","valueToStore","Function","setItem","stringify","validPageLink","originalName","toLowerCase","trim","replace","imageFileName","whenRetrieved","image_file","img","document","createElement","src","URL","createObjectURL","onload","canvas","canvas_context","getContext","width","height","drawImage","imgData","toDataURL","split","dictionaryUpdateKeyNested","dictionary","keys","updateFunction","length","shallowClone","slice","key","newDictionary","dictionaryUpdateKey","intoParsable","input","current_character_index","still_parsing","peek_character","look_ahead_offset","eat_character","withPreservedPosition","progn_fn","restoration_index","stillParsing","peekCharacter","requireCharacter","character","eatCharacter","consumeUntil","ending_predicate_fn","tryParseString","parsable","delimiter","acceptMultiline","successful_parse","string_contents","eatIdentifier","c","eatWhitespace","log","preprocessMarkdown","onImageFound","has_end","inbetween","image_tag","property","maybe_string","value_identifier","md","require","html","breaks","linkify","typographer","renderMarkdown","text","render","MarkdownRender","className","children","dangerouslySetInnerHTML","__html","Input","changeHandler","label","option","readOnly","props","defaultValue","InputOrTextarea","styles","group","textarea","onChange","shrink","Form","submitFn","inputItems","defaultItems","reduce","dict","setInput","e","target","submitHandler","preventDefault","onSubmit","map","idx","Button","type","styleOption","button","ImageURL","href","onClick","navigator","clipboard","writeText","then","alert","MediaPreview","imagePreviewInfo","updateImageURLs","thumbnail","image","alt","imageURLs","filter","MarkdownEditor","submissionHandler","currentArticle","existing_images","content","push","info","retrieveImageData","files","imgURL","success","concat","data","thumb","url","surrounder","sym","spacesLeft","spacesRight","i","repeat","surrounders","renderDomAsMarkdown","root","nodeType","textContent","hasChildNodes","text_contents","tagName","parentElement","Number","Array","from","accumulator","listItem","childText","fn","renderElement","childNodes","output","node","widgets","heading","active","types","h1","display","command","argument","category","h2","h3","h4","h5","h6","list","orderedList","unorderedList","bold","italic","underline","NoticeBanner","dirtyFlag","noticeBannerStyles","dropOut","dropIn","selfDirtyFlag","updateSelfDirtyFlag","style","updateStyle","main","RichTextEditor","editableTitleDOMRef","useRef","editableAreaDOMRef","execCommand","widgetStates","updateWidgetState","updateDirtyFlag","saveDocument","current","markdownText","toggleWidgetActiveState","widgetId","categoryValue","currentlyActive","executeRichTextCommand","commandName","optionalArgument","focus","queryRichTextCommand","wantedValue","queryCommandValue","queryCommandState","activeWidgetCategory","color","backgroundColor","Object","entries","copy","widget","_","title","contentEditable","ref","borderColor","borderWidth","margin","borderStyle","article","onSelect","newWidgetState","onKeyDown","event","shiftKey","disableDefaultBehavior","ctrlKey","stopPropagation","Admin","api","articlesData","setArticlesData","submissionData","onFinishedCallback","articles","insertArticle","queryForArticles","editorMarkdown","editorRichText","editorMode","setEditorMode","selected","ArticleRender","Article","React","adminEditView","updateAdminEditView","history","useHistory","context","useContext","ApplicationContext","isAdmin","deleteArticle","Header","header","navbar","to","logoDiv","prompt","setAdminState","Searchbar","returnInput","searchbar","autoFocus","placeholder","onKeyUp","clearDiv","clear","Homepage","searchResult","setSearchResult","sort","matched_characters","b","count","shorter_length","Math","min","toUpperCase","x","y","matched","approximateSearch","articleTitle","createContext","App","globalArticlesData","useEffect","setIsAdmin","Provider","exact","path","buildFromJSON","footer","errored","ReactDOM","StrictMode","getElementById","basename","module","exports"],"mappings":"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","file":"static/js/main.4228bfd7.chunk.js","sourcesContent":["/*\r\n  Store context sensitive information here\r\n */\r\nexport const Secrets = {\r\n    RECYCLOPEDIA_APPLICATION_ID: \"recyclopedia-api-uuuus\",\r\n    ADMIN_PASSWORD: \"tonyisugly\",\r\n    IMGBB_KEY: \"5eba0537206ecc76b4a505e866868853\"\r\n};\r\n","import * as Realm from \"realm-web\";\r\n\r\nexport class RecyclopediaApplicationContext {\r\n  constructor(appId, onFinishedLoadFn) {\r\n    const recyclopediaAnonymousCredentials = Realm.Credentials.anonymous();\r\n\r\n    this.application = new Realm.App({ id: appId });\r\n    this.applicationUser = undefined;\r\n\r\n    (async function () {\r\n      try {\r\n        const result = await this.application.logIn(recyclopediaAnonymousCredentials);\r\n        this.applicationUser = result;\r\n        onFinishedLoadFn.bind(this)(false);\r\n      } catch (error) {\r\n        console.error(\"Failed to login because: \", error);\r\n        onFinishedLoadFn.bind(this)(true);\r\n      }\r\n\r\n    }).bind(this)();\r\n  }\r\n\r\n  queryForArticles(query) {\r\n    // I should \"lazy-init\" login this\r\n    // however I forced a buffer load, before anything happens\r\n    // so I am guaranteed to have a user unless we couldn't login for some reason.\r\n    if (this.applicationUser) {\r\n        return (async function () {\r\n            if (query) {\r\n                return await this.applicationUser.functions.getAllArticles(query);\r\n            } else {\r\n                return await this.applicationUser.functions.getAllArticles();\r\n            }\r\n        }).bind(this)();\r\n    } else {\r\n      console.error(\"No user? This is bad news.\");\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  deleteArticle(name) {\r\n    if (this.applicationUser) {\r\n      (async function () {\r\n        this.applicationUser.functions.removeArticle(name);\r\n      }).bind(this)();\r\n    } else {\r\n      console.error(\"No user? This is bad news.\");\r\n    }\r\n  }\r\n\r\n  insertArticle(articleContents) {\r\n    if (this.applicationUser) {\r\n      (async function () {\r\n        await this.applicationUser.functions.createOrUpdateArticle(articleContents);\r\n      }).bind(this)();\r\n    } else {\r\n      console.error(\"No user? This is bad news.\");\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n}\r\n","import { useState } from 'react';\r\n\r\nfunction useLocalStorageState(itemName, initialValue) {\r\n  const [state, setState] = useState(() => {\r\n    try {\r\n      const item = localStorage.getItem(itemName);\r\n\r\n      return item\r\n        ? JSON.parse(item)\r\n        : initialValue;\r\n\r\n    } catch (err) {\r\n\r\n      console.error(err);\r\n      return initialValue;\r\n    }\r\n  });\r\n\r\n  const syncStateToLocalStorage = (value) => {\r\n    try {\r\n      const valueToStore = value instanceof Function\r\n        ? value(state)\r\n        : value;\r\n\r\n      setState(valueToStore);\r\n      localStorage.setItem(itemName, JSON.stringify(valueToStore));\r\n\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  return [state, syncStateToLocalStorage];\r\n}\r\n\r\nexport default useLocalStorageState;","import { Secrets } from \"secrets\";\r\n//Return the current property of a ref if it is a ref\r\nexport const getRefCurrent = (ref) => {\r\n  return ref.hasOwnProperty(\"current\")\r\n    ? ref.current\r\n    : ref;\r\n};\r\n\r\nexport const validPageLink = (originalName) => `/${originalName.toLowerCase().trim().replace(/ +/g, '_')}`;\r\n\r\nexport async function uploadImage(image_name) {\r\n  let form_data = new FormData();\r\n  form_data.append(\"image\", image_name);\r\n\r\n  const expirationValue = 600;\r\n  const requestUrl = `https://api.imgbb.com/1/upload?expiration${expirationValue}&key=${Secrets.IMGBB_KEY}`;\r\n  const res = await fetch(requestUrl, { method: \"POST\", body: form_data, });\r\n\r\n  return await res.json();\r\n}\r\n\r\nexport async function retrieveImageData(imageFileName, whenRetrieved) {\r\n  const image_file = imageFileName;\r\n  const img = document.createElement('img');\r\n  img.src = URL.createObjectURL(image_file);\r\n  img.onload = async function () {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const canvas_context = canvas.getContext(\"2d\");\r\n\r\n    canvas.width = img.width;\r\n    canvas.height = img.height;\r\n\r\n    canvas_context.drawImage(img, 0, 0);\r\n    const imgData = canvas.toDataURL().split(',')[1];\r\n    whenRetrieved(imgData);\r\n  };\r\n}\r\n\r\nexport function dictionaryUpdateKey(dictionary, key, updateFunction) {\r\n  let newDictionary = {...dictionary};\r\n  newDictionary[key] = updateFunction(dictionary[key]);\r\n  return newDictionary;\r\n}\r\n\r\n// return dictionaryUpdateKey(newWidgetState, type,\r\n//   function (typeField) {\r\n//     if (type === \"heading\") {\r\n//       return dictionaryUpdateKey(typeField, \"active\", () => queryRichTextCommand(\"heading\", true));\r\n//     } else {\r\n//       return dictionaryUpdateKey(typeField, \"active\", () => queryRichTextCommand(type) ? type : null);\r\n//     }\r\n//   });\r\n\r\nexport function dictionaryUpdateKeyNested(dictionary, keys, updateFunction) {\r\n  if (keys.length > 1)  {\r\n    let shallowClone = { ...dictionary };\r\n    shallowClone[keys[0]] = \r\n      dictionaryUpdateKeyNested(shallowClone[keys[0]], keys.slice(1), updateFunction);\r\n    return shallowClone;\r\n  }\r\n\r\n  return dictionaryUpdateKey(dictionary, keys[0], updateFunction);\r\n}","/*\r\n  Parsable is an interface produced from a string input.\r\n  \r\n  It'll convert a string into a `Parsable` object which removes the\r\n  ability to modify the string, and instead replaces it with reading\r\n  facilities that would be very useful for tokenizing or lexical analysis.\r\n  \r\n  To use just do:\r\n\r\n  object = intoParsable(\"abcdefghijklmnop\");\r\n  \r\n  There's also a few premade parsable functions that aid in building parsers.\r\n*/\r\n\r\nexport function intoParsable(input) {\r\n  // I'm internally using snake_case because I'm comfortable with it\r\n  // but everyone else uses camel case.\r\n  let current_character_index = 0;\r\n\r\n  function still_parsing() {\r\n    return (current_character_index < input.length);\r\n  }\r\n\r\n  function peek_character(look_ahead_offset = 0) {\r\n    if (current_character_index + look_ahead_offset > input.length) {\r\n      return null;\r\n    } else {\r\n      return input[current_character_index + look_ahead_offset];\r\n    }\r\n  }\r\n\r\n\r\n  function require_character(character) {\r\n    if (peek_character() === character) {\r\n      eat_character();\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function eat_character() {\r\n    if (current_character_index > input.length) {\r\n      return null;\r\n    } else {\r\n      const result = peek_character();\r\n      current_character_index++;\r\n      return result;\r\n    }\r\n  }\r\n\r\n  function consume_until(ending_predicate_fn) {\r\n    let result = \"\";\r\n\r\n    while (still_parsing()) {\r\n      if (ending_predicate_fn()) {\r\n        break;\r\n      } else {\r\n        result += eat_character();\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  function with_preserved_position(progn_fn) {\r\n    const restoration_index = current_character_index;\r\n    let result = progn_fn();\r\n    current_character_index = restoration_index;\r\n    return result;\r\n  }\r\n\r\n  return {\r\n    withPreservedPosition: with_preserved_position,\r\n    stillParsing: still_parsing,\r\n    peekCharacter: peek_character,\r\n    requireCharacter: require_character,\r\n    eatCharacter: eat_character,\r\n    consumeUntil: consume_until,\r\n  };\r\n}\r\n\r\n// TODO(jerry): add escaped characters!\r\nexport function tryParseString(parsable, { delimiter, acceptMultiline }) {\r\n  if (parsable.requireCharacter(delimiter)) {\r\n    let successful_parse = true;\r\n    let string_contents = parsable.consumeUntil(\r\n      function () {\r\n        if (!acceptMultiline && parsable.requireCharacter('\\n')) {\r\n          successful_parse = false;\r\n          return true;\r\n        } else if (parsable.requireCharacter(delimiter)) {\r\n          return true;\r\n        }\r\n        return false;\r\n      }\r\n    );\r\n    if (string_contents && successful_parse) {\r\n      return string_contents;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n// Pairs are singular characters unfortunately.\r\n// not strings.\r\nexport function matchedQuotePairs(parsable) {\r\n  return true;\r\n\r\n  // Henry: Commented out to resolve warnings in console\r\n\r\n  // return parsable.withPreservedPosition(\r\n  //   function () {\r\n  //     let count = 0;\r\n\r\n  //     while (parsable.stillParsing()) {\r\n  //       if (parsable.requireCharacter('\\\\')) {\r\n  //         parsable.eatCharacter();\r\n  //       } else {\r\n  //         if (parsable.requireCharacter('\\'')) {\r\n  //           count++;\r\n  //         }\r\n  //         parsable.eatCharacter();\r\n  //       }\r\n  //     }\r\n\r\n  //     return (count % 2 === 0);\r\n  //   }\r\n  // );\r\n}\r\n\r\n// console.log(tryParseString(intoParsable('\\'Hello\\nWorld!\\'|'), {delimiter: '\\'', acceptMultiline: true}));\r\n// console.log(tryParseString(intoParsable('\\'Hello\\nWorld!\\'|'), {delimiter: '\\''}));\r\n\r\nconst is_literal_acceptable = (c) => (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') || (c >= '0' && c <= '9');\r\nexport function eatIdentifier(parsable) {\r\n  if (parsable.stillParsing()) {\r\n    return parsable.consumeUntil(() => !is_literal_acceptable(parsable.peekCharacter()));\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function eatWhitespace(parsable) {\r\n  while (parsable.stillParsing()) {\r\n    if (parsable.peekCharacter() === ' ') {\r\n      parsable.eatCharacter();\r\n    } else {\r\n      console.log(parsable.peekCharacter());\r\n      break;\r\n    }\r\n  }\r\n}\r\n","/*\r\n  This is the markdown preprocessor for any special extensions we might want to support.\r\n  \r\n  Does not really do tokenizing, so be ware of dragons.\r\n */\r\nimport { intoParsable, tryParseString, eatIdentifier, eatWhitespace } from 'utils/intoParsable';\r\n\r\nexport function preprocessMarkdown(input, onImageFound=undefined) {\r\n    let result = \"\";\r\n    input = intoParsable(input);\r\n\r\n    while (input.stillParsing()) {\r\n        if (input.requireCharacter('\\\\')) {\r\n            result += input.eatCharacter();\r\n        } else if (input.requireCharacter('@')) {\r\n            if (input.requireCharacter('@')) {\r\n                let has_end = false;\r\n                /*\r\n                  Whenever our region fails to parse it'll just refuse to output anything.\r\n                  \r\n                  @ asdf @ asdf -> @ asdf @ asdf\r\n                  @@ asdf @ asdf -> null\r\n                  @@ asdf @@ asdf -> whatever we would've parsed.\r\n                  \r\n                  if you need multiple @ signs consecutively just do\r\n                  \\@\\@ or @\\@.\r\n                 */\r\n                let inbetween = intoParsable(\r\n                    input.consumeUntil(\r\n                        function() {\r\n                            if (input.requireCharacter('\\n')) {\r\n                                return true;\r\n                            } else if (input.requireCharacter('@')) {\r\n                                /*\r\n                                  When we encounter an @ sign, it's likely to be the end of parsing a \"region\".\r\n                                 */\r\n                                if (input.requireCharacter('@')) {\r\n                                    has_end = true;\r\n                                }\r\n                                return true;\r\n                            }\r\n                            return false;\r\n                        }\r\n                    )\r\n                );\r\n\r\n                if (inbetween && has_end) {\r\n                    let image_tag = \"<img \";\r\n                    let error = false;\r\n                    \r\n                    while (inbetween.stillParsing() && !error) {\r\n                        eatWhitespace(inbetween);\r\n                        let property = eatIdentifier(inbetween);\r\n                        if (property) {\r\n                            image_tag += property;\r\n                            eatWhitespace(inbetween);\r\n                            if (inbetween.requireCharacter('=')) {\r\n                                image_tag += \"=\";\r\n                                eatWhitespace(inbetween);\r\n                                if (inbetween.peekCharacter() === '\\'') {\r\n                                    let maybe_string = tryParseString(inbetween, {delimiter: '\\''});\r\n                                    if (maybe_string) {\r\n                                        image_tag += '\\'' + maybe_string + '\\'';\r\n                                        if (property === \"src\" && onImageFound) {\r\n                                            onImageFound(maybe_string);\r\n                                        }\r\n                                    } else {\r\n                                        console.error(\"No string value?\");\r\n                                        error = true;\r\n                                    }\r\n                                } else {\r\n                                    let value_identifier = eatIdentifier(inbetween);\r\n                                    if (value_identifier) {\r\n                                        image_tag += value_identifier;\r\n                                    } else {\r\n                                        console.error(\"No value identifier?\");\r\n                                        error = true;\r\n                                    }\r\n                                }\r\n                                eatWhitespace(inbetween);\r\n                                if (!inbetween.requireCharacter('|')) {\r\n                                    if (eatIdentifier(inbetween) || tryParseString(inbetween, {delimiter: '\\''})) {\r\n                                        console.error(\"Missing pipe separator!\");\r\n                                        error = true;\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                console.error(\"Missing assignment for property?\");\r\n                                error = true;\r\n                            }\r\n                        } else {\r\n                            console.error(\"Could not find property name!\");\r\n                            error = true;\r\n                        }\r\n                        image_tag += \" \";\r\n                    }\r\n                    image_tag += \"/>\";\r\n                    if (!error) {\r\n                        result += image_tag;\r\n                    } else {\r\n                        console.log(\"error happened\");\r\n                    }\r\n                } else {\r\n                    // not valid tag. Don't do anything.\r\n                    // maybe add a newline since there should really only be one image per\r\n                    // line as per markup style.\r\n                    result += '\\n';\r\n                }\r\n            } else {\r\n                result += '@';\r\n            }\r\n        } else {\r\n            result += input.eatCharacter();\r\n        }\r\n    }\r\n\r\n    return result;\r\n}","const md = require('markdown-it')(\r\n  {\r\n    html: true,\r\n    breaks: true,\r\n    linkify: true,\r\n    typographer: true,\r\n  }\r\n);\r\n\r\nexport const renderMarkdown = (text) => md.render(text);\r\nexport function MarkdownRender({className, children}) {\r\n    return (<div\r\n        className={className}\r\n        dangerouslySetInnerHTML={{ __html: renderMarkdown(children) }}>\r\n    </div>);\r\n}","import styles from 'components/Form/Input.module.scss';\r\n\r\nconst Input = ({\r\n  changeHandler,\r\n  label,\r\n  option,\r\n  readOnly,\r\n  value,\r\n  defaultValue,\r\n  ...props\r\n}) => {\r\n  const InputOrTextarea = option || 'input';\r\n\r\n  return (\r\n    <div className={styles.group}>\r\n      <InputOrTextarea\r\n        className={(option === 'textarea') ? styles.textarea : styles.input}\r\n        onChange={changeHandler}\r\n        {...(readOnly ? { defaultValue: value, readOnly: true } : { value: value })}\r\n        {...props}\r\n      />\r\n      {\r\n        label && (\r\n          <label\r\n            className={`${value ? styles.shrink : ''}`}\r\n          >\r\n            {label}\r\n          </label>\r\n        )\r\n      }\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Input;\r\n","import { useState } from 'react';\r\n\r\nimport Input from 'components/Form/Input';\r\n\r\nconst Form = ({ submitFn, children, inputItems }) => {\r\n  const defaultItems = inputItems.reduce((\r\n    dict, item\r\n  ) => {\r\n    dict[item[0]] = item[2]?.defaultValue || '';\r\n    return dict;\r\n  }, {});\r\n\r\n  const [input, setInput] = useState(defaultItems);\r\n\r\n  const changeHandler = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    setInput({\r\n      ...input,\r\n      [name]: value\r\n    });\r\n  };\r\n\r\n  const submitHandler = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const reset = submitFn\r\n      ? await submitFn(input)\r\n      : true;\r\n\r\n    reset && setInput(defaultItems);\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={submitHandler}>\r\n      {\r\n        inputItems.map((item, idx) => (\r\n          <Input\r\n            key={idx}\r\n            changeHandler={changeHandler}\r\n            name={item[0]}\r\n            value={input[item[0]]}\r\n            label={item[1]}\r\n            {...item[2]}\r\n          />\r\n        ))\r\n      }\r\n      {children}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Form;","import styles from 'components/Form/Button.module.scss';\n\nconst Button = ({\n  children = '',\n  type = 'button',\n  styleOption,\n  ...props\n}) => {\n  return (\n    <button\n      className={`${styles.button} ${styleOption ? styles[styleOption] : ''}`}\n      type={type}\n      {...props}\n    >\n      {children}\n    </button>\n  );\n};\n\nexport default Button;\n","function ImageURL({ children }) {\r\n  return (\r\n    <a\r\n      href=\"#\"\r\n      onClick={\r\n        () => {\r\n          navigator.clipboard.writeText(`@@src='${children}'@@`).then(\r\n            function () {\r\n              alert(\"copied to clipboard\");\r\n            }\r\n          );\r\n        }}>\r\n      {children}\r\n    </a>\r\n  );\r\n}\r\n\r\nexport function MediaPreview({ imagePreviewInfo, updateImageURLs }) {\r\n  const [thumbnail, image] = imagePreviewInfo;\r\n\r\n  return (\r\n    <div className=\"image-preview-thing\">\r\n      <img key={thumbnail} src={thumbnail} alt={image} width=\"80px\"></img>\r\n      <ImageURL>{image}</ImageURL>\r\n      <button\r\n        onClick={() => {\r\n          updateImageURLs(imageURLs => imageURLs.filter(([previewName]) => (previewName !== thumbnail)));\r\n        }}\r\n      >\r\n        X\r\n      </button>\r\n    </div>\r\n  );\r\n}","import React, { useState } from 'react';\r\nimport { preprocessMarkdown } from 'utils/preprocessMarkdown';\r\n\r\nimport Form from 'components/Form/Form';\r\nimport Button from 'components/Form/Button';\r\n\r\nimport { uploadImage, retrieveImageData } from 'utils/functions';\r\nimport { MediaPreview } from \"../MediaPreview\";\r\n\r\nexport function MarkdownEditor({ submissionHandler, currentArticle }) {\r\n  const [imageURLs, updateImageURLs] = useState(\r\n    function () {\r\n      let existing_images = [];\r\n      if (currentArticle?.content) {\r\n        preprocessMarkdown(currentArticle.content, (img) => existing_images.push([img, img]));\r\n      }\r\n      return existing_images;\r\n    }()\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <h2>Upload Media</h2>\r\n      {\r\n        imageURLs.map((info) => <MediaPreview updateImageURLs={updateImageURLs} imagePreviewInfo={info} />)\r\n      }\r\n      <form>\r\n        <input\r\n          type=\"file\"\r\n          onChange={\r\n            ({ target }) => {\r\n              retrieveImageData(target.files[0],\r\n                function (imgURL) {\r\n                  if (imgURL.success) {\r\n                    updateImageURLs(imageURLs.concat([[imgURL.data.thumb.url, imgURL.data.url]]));\r\n                  } else {\r\n                    console.error(\"IMGBB is down. Tony pls get us a server\");\r\n                  }\r\n                });\r\n            }\r\n          }\r\n        />\r\n      </form>\r\n\r\n      <Form\r\n        submitFn={(input) => submissionHandler(input)}\r\n        inputItems={[\r\n          [\"name\",\r\n            \"Name\",\r\n            (currentArticle?.name) &&\r\n            {\r\n              defaultValue: currentArticle.name,\r\n              readOnly: true\r\n            }\r\n          ],\r\n          [\"content\", \"Content\",\r\n            {\r\n              option: 'textarea',\r\n              defaultValue: (currentArticle?.content) && currentArticle.content\r\n            }\r\n          ]\r\n        ]}\r\n      >\r\n        <Button type='submit'>\r\n          {(currentArticle)\r\n            ? \"Save Article\"\r\n            : \"Submit Article\"}\r\n        </Button>\r\n      </Form>\r\n    </>\r\n  );\r\n}","/*\r\n    Inhouse DOM to Markdown interpreter.\r\n*/\r\nfunction surrounder(sym) {\r\n    return function (content) {\r\n        let spacesLeft = 0;\r\n        let spacesRight = 0;\r\n        for (let i = 0; i < content.length; ++i) {\r\n            if (content[i] !== ' ') {\r\n                spacesLeft = i-1;\r\n                break;\r\n            }\r\n        }\r\n        for (let i = content.length - 1; i > 0; --i) {\r\n            if (content[i] !== ' ') {\r\n                break;\r\n            }\r\n            spacesRight++;\r\n        }\r\n        return `${spacesLeft > 0 ? \" \".repeat(spacesLeft) : \"\"}${sym}${content.trim()}${sym}${spacesRight > 0 ? \" \".repeat(spacesRight) : \"\"}`;\r\n    }\r\n}\r\nconst surrounders = {\r\n    \"B\": surrounder(\"**\"),\r\n    \"I\": surrounder(\"_\"),\r\n    \"U\": surrounder(\"__\"),\r\n};\r\nconst safe_call = (fn, ...rest) => (...rest) => (fn) ? fn(...rest) : rest[0];\r\n/*\r\nNOTE(jerry):\r\n\r\nI'm not a particular fan of this since this is definitely very scrappy. It does not know how to\r\nproperly handle nested lists, although without extra modification the RichTextEditor doesn't allow you\r\nto do nested lists trivially anyways... So hopefully it's not much of a disaster (just store the current indent\r\nlevel and then do it based off of whatever markdown seems to recognize a list as.)\r\n\r\nMost other normal elements are handled fine, it's really just the lists I'm concerned about.\r\n\r\nThis is entirely recursive, and because it's recursive it loses some information that may be useful for\r\ncleaner and probably easier rendering...\r\n*/\r\nfunction renderElement(root, text_contents) {\r\n    if (text_contents !== \"\") {\r\n        if (root.tagName === \"P\") {\r\n            console.log(\"paragraph\");\r\n            console.log(root.parentElement);\r\n            if (root.parentElement && (root.parentElement.tagName === \"LI\")) {\r\n                console.log(\"Parent was list?\");\r\n                return text_contents;\r\n            } else {\r\n                return text_contents + \"\\n\";\r\n            }\r\n        } else if (root.tagName[0] === 'H') {\r\n            return \"#\".repeat(Number(root.tagName[1])) + \" \" + text_contents + \"\\n\";\r\n        } else if (root.tagName === \"OL\") {\r\n            let i = 0;\r\n            return Array.from(root.children).reduce(\r\n                function (accumulator, listItem) {\r\n                    const childText = renderDomAsMarkdown(listItem);\r\n                    if (childText !== \"\") {\r\n                        return accumulator + `${((i++) + 1)}. ${childText}\\n`;\r\n                    } else {\r\n                        return accumulator;\r\n                    }\r\n                } , \"\");\r\n        } else if (root.tagName === \"UL\") {\r\n            return Array.from(root.children).reduce(\r\n                function (accumulator, listItem) {\r\n                    const childText = renderDomAsMarkdown(listItem);\r\n                    if (childText !== \"\") {\r\n                        return accumulator + `- ${childText}\\n`;\r\n                    } else {\r\n                        return \"\";\r\n                    }\r\n                } , \"\");\r\n        }\r\n\r\n        return safe_call(surrounders[root.tagName])(text_contents);\r\n    } else {\r\n        return (root.tagName === \"P\") ? \"\\\\\\n\" : \"\";\r\n    }\r\n}\r\n\r\nexport function renderDomAsMarkdown(root) {\r\n    if (root.nodeType === 3) {\r\n        return root.textContent;\r\n    } else if (root.hasChildNodes()) {\r\n        const childrenStrings = Array.from(root.childNodes).reduce((output, node) => { return output + renderDomAsMarkdown(node) }, \"\");\r\n        const res = renderElement(root, childrenStrings);\r\n        return res;\r\n    }\r\n\r\n    return \"\";\r\n}\r\n","import React, { useState, useRef } from 'react';\r\nimport { preprocessMarkdown } from 'utils/preprocessMarkdown';\r\n\r\nimport { renderMarkdown } from \"components/Article/RenderMarkdown\";\r\nimport { renderDomAsMarkdown } from 'utils/DOMIntoMarkdown';\r\nimport { dictionaryUpdateKey, dictionaryUpdateKeyNested } from 'utils/functions';\r\n\r\nimport styles from 'pages/Admin/Admin.module.scss';\r\nimport noticeBannerStyles from './NoticeBanner.module.scss';\r\n\r\nimport Button from 'components/Form/Button';\r\n\r\nconst widgets = {\r\n  heading: {\r\n    active: null,\r\n    types: {\r\n      h1: { name: \"Heading 1\", display: <b>h1</b>, command: \"heading\", argument: \"H1\", category: \"heading\" },\r\n      h2: { name: \"Heading 2\", display: <b>h2</b>, command: \"heading\", argument: \"H2\", category: \"heading\" },\r\n      h3: { name: \"Heading 3\", display: <b>h3</b>, command: \"heading\", argument: \"H3\", category: \"heading\" },\r\n      h4: { name: \"Heading 4\", display: <b>h4</b>, command: \"heading\", argument: \"H4\", category: \"heading\" },\r\n      h5: { name: \"Heading 5\", display: <b>h5</b>, command: \"heading\", argument: \"H5\", category: \"heading\" },\r\n      h6: { name: \"Heading 6\", display: <b>h6</b>, command: \"heading\", argument: \"H6\", category: \"heading\" },\r\n    }\r\n  },\r\n  list: {\r\n    active: null,\r\n    types: {\r\n      orderedList: { name: \"Ordered List\", command: \"insertorderedlist\", category: \"list\" },\r\n      unorderedList: { name: \"Unordered List\", command: \"insertunorderedlist\", category: \"list\" },\r\n    }\r\n  },\r\n  // disadvantage at the moment. You don't have to do this, but this makes the current format work without code changes\r\n  bold: {\r\n    active: null,\r\n    types: {\r\n      bold: { name: \"Bold\", display: <b>B</b>, command: \"bold\" }\r\n    }\r\n  },\r\n  italic: {\r\n    active: null,\r\n    types: {\r\n      italic: { name: \"Italic\", display: <emph>I</emph>, command: \"italic\" }\r\n    }\r\n  },\r\n  underline: {\r\n    active: null,\r\n    types: {\r\n      underline: { name: \"Underline\", display: <u>UL</u>, command: \"underline\" }\r\n    }\r\n  },\r\n};\r\n\r\nfunction NoticeBanner({children, dirtyFlag}) {\r\n  const styles = [noticeBannerStyles.dropOut, noticeBannerStyles.dropIn];\r\n\r\n  const [selfDirtyFlag, updateSelfDirtyFlag] = useState(dirtyFlag);\r\n  const [style, updateStyle] = useState(0);\r\n\r\n  if (dirtyFlag !== selfDirtyFlag) {\r\n      updateStyle((style+1));\r\n      updateSelfDirtyFlag(!selfDirtyFlag);\r\n  }\r\n\r\n  return (\r\n    <div className={noticeBannerStyles.main + \" \" + styles[style % 2]}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n/*\r\n  I'm actually not 100% sure of how we should `data-bind` two separate representations of the same document. Ideally we\r\n  should really only pick one as the source of truth, and the more convenient one to pick is markdown.\r\n\r\n  This is technically experimental anyways.\r\n*/\r\nexport function RichTextEditor({ submissionHandler, currentArticle }) {\r\n  const editableTitleDOMRef = useRef();\r\n  const editableAreaDOMRef = useRef();\r\n\r\n  document.execCommand(\"defaultParagraphSeparator\", false, \"p\");\r\n  const [widgetStates, updateWidgetState] = useState(widgets);\r\n  const [dirtyFlag, updateDirtyFlag] = useState(false);\r\n\r\n  function saveDocument() {\r\n    if (editableAreaDOMRef.current && editableTitleDOMRef) {\r\n      const markdownText = renderDomAsMarkdown(editableAreaDOMRef.current);\r\n      submissionHandler({ name: (currentArticle) ? currentArticle.name : editableTitleDOMRef.current.textContent, content: markdownText });\r\n      updateDirtyFlag(false);\r\n    }\r\n  }\r\n\r\n  // would only apply to a few relevant states.\r\n  function toggleWidgetActiveState(widgetId, categoryValue) {\r\n    updateWidgetState(\r\n      dictionaryUpdateKeyNested(\r\n        widgetStates,\r\n        [(categoryValue) ? (categoryValue) : (widgetId), \"active\"],\r\n        (currentlyActive) => (currentlyActive === widgetId) ? null : widgetId\r\n      )\r\n    );\r\n  }\r\n\r\n  function flattenWidgetStateTypes() {\r\n    return Object.entries(widgetStates).reduce(\r\n      function (accumulator, [id, { types }]) {\r\n        return Object.entries(types).reduce(\r\n          function (accumulator, [key, value]) {\r\n            // can probably use updateKeyValue, but not trying it here.\r\n            let copy = { ...accumulator };\r\n            copy[key] = value;\r\n            return copy;\r\n          },\r\n          accumulator\r\n        );\r\n      }\r\n      , {});\r\n  }\r\n\r\n  function executeRichTextCommand(commandName, optionalArgument) {\r\n    if (editableAreaDOMRef.current) {\r\n        document.execCommand(commandName, false, optionalArgument);\r\n        editableAreaDOMRef.current.focus();\r\n    }\r\n  }\r\n\r\n  function queryRichTextCommand(command, wantedValue) {\r\n    if (wantedValue) {\r\n      return document.queryCommandValue(command);\r\n    } else {\r\n      return document.queryCommandState(command);\r\n    }\r\n  }\r\n\r\n  function synchronizeCommandStateToWidgetBar() {\r\n    updateWidgetState(\r\n      Object.keys(widgetStates).reduce(\r\n        (newWidgetState, type) => {\r\n          return dictionaryUpdateKeyNested(newWidgetState, [type, \"active\"],\r\n            (type === \"heading\") ?\r\n              () => queryRichTextCommand(type, true) :\r\n              () => queryRichTextCommand(type) ? type : null\r\n          );\r\n        }, widgetStates)\r\n    );\r\n  }\r\n\r\n  const editModeInlineStyle = { \r\n    borderColor: \"black\",\r\n    borderWidth: \"1px\",\r\n    margin: \"0.3em\",\r\n    borderStyle: \"solid\",\r\n  };\r\n\r\n  const activeWidgetCategory = {\r\n    color: \"red\",\r\n    backgroundColor: \"blue\",\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div> {/*requires styling*/}\r\n        {\r\n          Object.entries(flattenWidgetStateTypes()).map(\r\n            ([widgetId, widget]) => (<button\r\n              key={widgetId}\r\n              id={widgetId}\r\n              style={ \r\n                ((widgetStates[(widget.category !== undefined) ? widget.category : widgetId].active) === widgetId)\r\n                  ? activeWidgetCategory : {}}\r\n              onClick={\r\n                (_) => {\r\n                  toggleWidgetActiveState(widgetId, widget.category);\r\n                  executeRichTextCommand(widget.command, widget.argument);\r\n                }\r\n              }>{(widget.display) ? widget.display : widget.name}</button>)\r\n          )\r\n        }\r\n      </div>\r\n      <NoticeBanner dirtyFlag={dirtyFlag}>You have unsaved changes!</NoticeBanner> : <></>\r\n      <h1 className={styles.title} contentEditable={(currentArticle) ? \"false\" : \"true\"} ref={editableTitleDOMRef}>\r\n        {(currentArticle) ? currentArticle.name : \"Edit New Title\"}\r\n      </h1>\r\n      <div style={editModeInlineStyle}>\r\n        <div\r\n          contentEditable={true}\r\n          className={styles.article}\r\n          onSelect={synchronizeCommandStateToWidgetBar}\r\n          onKeyDown={\r\n            // I would hipster write this too, but I'll just write this in a simple fashion\r\n            function(event) {\r\n              let {key, shiftKey, ctrlKey} = event;\r\n              let disableDefaultBehavior = false;\r\n              if (ctrlKey) {\r\n                if (!shiftKey) {\r\n                  switch (key) {\r\n                    case 's':\r\n                      saveDocument();\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                    case 'b':\r\n                      toggleWidgetActiveState(\"bold\");\r\n                      executeRichTextCommand(\"bold\");\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                    case 'i':\r\n                      toggleWidgetActiveState(\"italic\");\r\n                      executeRichTextCommand(\"italic\");\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                    case 'u':\r\n                      toggleWidgetActiveState(\"underline\");\r\n                      executeRichTextCommand(\"underline\");\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                    case '1': case '2': case '3': case '4': case '5': case '6':\r\n                      toggleWidgetActiveState(`h${key}`, \"heading\");\r\n                      executeRichTextCommand(\"heading\", `H${key}`);\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                  }\r\n                } else {\r\n                  console.log(\"CTRL and SHIFT\", key);\r\n                  switch (key) {\r\n                    case 'U':\r\n                      console.log(\"unordered list\");\r\n                      executeRichTextCommand(\"insertunorderedlist\");\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                    case 'O':\r\n                      executeRichTextCommand(\"insertorderedlist\");\r\n                      disableDefaultBehavior = true;\r\n                      break;\r\n                  }\r\n                }\r\n              }\r\n\r\n              if (disableDefaultBehavior) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n              } else {\r\n                updateDirtyFlag(true);\r\n              }\r\n            }\r\n          }\r\n          dangerouslySetInnerHTML={\r\n            { __html: renderMarkdown(preprocessMarkdown((currentArticle) ? currentArticle.content : \"Begin typing your article.\")) }\r\n          }\r\n          ref={editableAreaDOMRef}>\r\n        </div>\r\n      </div>\r\n      <br></br>\r\n      <Button onClick={saveDocument}>\r\n        {(currentArticle)\r\n          ? \"Save Article\"\r\n          : \"Submit Article\"}\r\n      </Button>\r\n    </>\r\n  );\r\n}","import React, { useState } from 'react';\r\nimport { MarkdownEditor } from \"./Editors/MarkdownEditor\";\r\nimport { RichTextEditor } from \"./Editors/RichTextEditor\";\r\n\r\nimport { TagEditor } from 'pages/Admin/TagEditor.jsx';\r\n\r\nfunction submitHandler({ api, articlesData, setArticlesData, currentArticle }, input, onFinishedCallback) {\r\n  setArticlesData({\r\n    ...articlesData,\r\n    articles: articlesData.articles.map(item => ({\r\n      name: item.name,\r\n      content: (item.name === input.name) ? input.content : item.content,\r\n    }))\r\n  });\r\n\r\n  (async function () {\r\n    await api.insertArticle(input);\r\n    if (onFinishedCallback) {\r\n      onFinishedCallback(input);\r\n    }\r\n    let result = await api.queryForArticles();\r\n    setArticlesData(result);\r\n  })();\r\n}\r\n\r\nexport default function Admin({ api, articlesData, setArticlesData, currentArticle }) {\r\n  const submissionHandler = function (submissionData) {\r\n    submitHandler(\r\n      { api, articlesData, setArticlesData, currentArticle, },\r\n      submissionData,\r\n      function ({ name, content }) {\r\n        console.log(`Article ${name} written!`);\r\n      });\r\n  };\r\n  const editorMarkdown = (\r\n    <MarkdownEditor\r\n      submissionHandler={submissionHandler}\r\n      currentArticle={currentArticle}>\r\n    </MarkdownEditor>\r\n  );\r\n  const editorRichText = (\r\n    <RichTextEditor\r\n      submissionHandler={submissionHandler}\r\n      currentArticle={currentArticle}>\r\n    </RichTextEditor>\r\n  );\r\n  const [editorMode, setEditorMode] = useState(editorRichText);\r\n  return (\r\n    <>\r\n      <select\r\n        onChange={\r\n          function (event) {\r\n            switch (event.target.value) {\r\n              case \"richtext\":\r\n                setEditorMode(editorRichText);\r\n                break;\r\n              case \"markdown\":\r\n              default:\r\n                setEditorMode(editorMarkdown);\r\n                break;\r\n            }\r\n          }\r\n        }>\r\n        <option value=\"markdown\">Manual Markdown Editor</option>\r\n        <option value=\"richtext\" selected>Experimental Rich Text Editor</option>\r\n      </select>\r\n      {editorMode}\r\n      {/* <TagEditor articlesData={articlesData} setArticlesData={setArticlesData} currentArticle={currentArticle}/> */}\r\n    </>);\r\n}\r\n","import React, { useContext } from 'react';\r\nimport { Route, useHistory } from 'react-router-dom';\r\n\r\nimport styles from 'components/Article/Article.module.scss';\r\nimport { validPageLink } from 'utils/functions';\r\nimport { preprocessMarkdown } from 'utils/preprocessMarkdown';\r\nimport { MarkdownRender } from \"components/Article/RenderMarkdown\";\r\n\r\nimport Admin from 'pages/Admin/Admin';\r\n\r\nimport { ApplicationContext } from 'App';\r\n\r\nconst md = require('markdown-it')(\r\n    {\r\n        html: true,\r\n        breaks: true,\r\n        linkify: true,\r\n        typographer: true,\r\n    }\r\n);\r\n\r\nexport function buildFromJSON({ article, api, articlesData, setArticlesData }) {\r\n    const {name} = article;\r\n    return (\r\n        <Route key={name} exact path={validPageLink(name)}>\r\n          <Article article={article} api={api} articlesData={articlesData} setArticlesData={setArticlesData} />\r\n        </Route>\r\n    );\r\n}\r\n\r\nexport function ArticleRender({ name, content }) {\r\n    return (\r\n        <div>\r\n          <h1 className={styles.title}> {name} </h1>\r\n          <MarkdownRender className={styles.article}>\r\n            {preprocessMarkdown(content)}\r\n          </MarkdownRender>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function Article({ article, api, articlesData, setArticlesData }) {\r\n    const [adminEditView, updateAdminEditView] = React.useState(false);\r\n    const {name, content} = article;\r\n    const history = useHistory();\r\n\r\n    const context = useContext(ApplicationContext);\r\n\r\n    return <>\r\n  {\r\n      (context.isAdmin) && (\r\n          <>\r\n            <button\r\n              onClick={() => {\r\n                  api.deleteArticle(name);\r\n                  history.push('/');\r\n                  articlesData.articles = articlesData.articles.filter(item => item.name !== name);\r\n                  setArticlesData(articlesData);\r\n              }}\r\n            >\r\n              Delete Page\r\n            </button>\r\n            <button\r\n              onClick={() => updateAdminEditView(!adminEditView)}\r\n            >\r\n              Edit This Page\r\n            </button>\r\n          </>\r\n      )\r\n  }\r\n  { (adminEditView)\r\n    ? (<Admin\r\n                    currentArticle={{...article}}\r\n                    api={api}\r\n                    articlesData={articlesData}\r\n                    setArticlesData={setArticlesData} />\r\n      ) : \r\n    <ArticleRender name={name} content={content} />\r\n  }\r\n</>;\r\n}\r\n","import styles from 'pages/Header/Header.module.scss';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport { ApplicationContext } from 'App';\r\nimport { useContext } from 'react';\r\n\r\nimport { Secrets } from 'secrets';\r\n\r\n\r\nconst Header = () => {\r\n  const context = useContext(ApplicationContext);\r\n\r\n  return (\r\n    <header id={styles.header}>\r\n      <nav id={styles.navbar}>\r\n        <Link to=\"/\">\r\n          <div id={styles.logoDiv}></div>\r\n        </Link>\r\n\r\n        {(\r\n          context.isAdmin\r\n        ) ? (\r\n          <Link to=\"/admin\">\r\n            New Article\r\n          </Link>\r\n        ) : (\r\n          <button\r\n            onClick={() => {\r\n              if (prompt(\"Enter Admin Password\") === Secrets.ADMIN_PASSWORD) {\r\n                context.setAdminState(true);\r\n              }\r\n            }}\r\n          >\r\n            Admin\r\n          </button>\r\n        )}\r\n      </nav>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default Header;","import React, { useState, useRef } from 'react';\r\nimport styles from 'components/Searchbar/Searchbar.module.scss';\r\n\r\nexport default function Searchbar({ returnInput }) {\r\n  const [input, setInput] = useState('');\r\n  const searchbar = useRef(null);\r\n\r\n  return (\r\n    <div id={styles.searchbar}>\r\n      <input\r\n        autoFocus\r\n        type='text'\r\n        placeholder='Search'\r\n        ref={searchbar}\r\n        value={input}\r\n        onChange={\r\n          e => setInput(e.target.value)\r\n        }\r\n        onKeyUp={e =>\r\n          e.key === 'Enter' && returnInput((e.target).value)\r\n        }\r\n      />\r\n      <div id={styles.clearDiv}>\r\n        <span\r\n          id={styles.clear}\r\n          className='material-icons btn'\r\n          onClick={() => {\r\n            setInput('');\r\n            searchbar.current && searchbar.current.focus();\r\n          }}\r\n        >\r\n          clear\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import { Link } from 'react-router-dom';\r\n\r\nimport { validPageLink } from 'utils/functions';\r\nimport styles from 'pages/Homepage/Homepage.module.scss';\r\nimport Searchbar from 'components/Searchbar/Searchbar';\r\nimport approximateSearch from 'utils/search';\r\nimport { useState } from 'react';\r\n\r\nfunction Homepage({ api, setArticlesData, articlesData }) {\r\n  const [searchResult, setSearchResult] = useState([]);\r\n\r\n  const search = (input) => {\r\n    setSearchResult(\r\n      approximateSearch(\r\n        articlesData.articles.map(({ name }) => name),\r\n        input\r\n      )\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h1>Welcome to Recyclopedia</h1>\r\n      <Searchbar returnInput={search} />\r\n      {\r\n        searchResult.map((articleTitle) => (\r\n          <Link to={validPageLink(articleTitle)}>\r\n            <u><p>{articleTitle}</p></u>\r\n          </Link>\r\n        ))\r\n      }\r\n      <br />\r\n      {\r\n        articlesData.articles.map(({ name }) => (\r\n          <p key={name} >\r\n            <Link to={validPageLink(name)}>\r\n              {name}\r\n            </Link>\r\n          </p>\r\n        ))\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Homepage;","export default function approximateSearch(entries, key) {\r\n    let copy = [...entries].sort();\r\n\r\n    // case insensitive\r\n    function matched_characters(a, b) {\r\n        if (a !== undefined && b !== undefined) {\r\n            let count = 0;\r\n            let shorter_length = Math.min(a.length, b.length);\r\n\r\n            for (let i = 0; i < shorter_length; ++i) {\r\n                if (a[i].toUpperCase() === b[i].toUpperCase()) {\r\n                    count++;\r\n                } else {\r\n                    return count;\r\n                }\r\n            }\r\n\r\n            return count;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    // This will result in the `key` item percolating itself upwards, which is what we want\r\n    // related entries will show up nearby. Anything that is not directly alphabetically related is going to\r\n    // be trouble.\r\n    copy = copy.sort(\r\n        (x, y) => {\r\n            let matched = [matched_characters(x, key), matched_characters(y, key)];\r\n            if (matched[0] !== 0 || matched[1] !== 0) {\r\n                // Closer matches get pushed forwards.\r\n                if (matched[0] > matched[1]) {\r\n                    return -1;\r\n                } else if (matched[0] < matched[1]) {\r\n                    return 1;\r\n                } else {\r\n                    return -1;\r\n                }\r\n            } else {\r\n                // none of them match the characters...\r\n                // Push them to the back, they are irrelevant.\r\n                if (y !== undefined) {\r\n                    if (y < key) {\r\n                        return 1;\r\n                    } else if (y > key) {\r\n                        return 1;\r\n                    } else {\r\n                        // This is the key itself.\r\n                        return -1;\r\n                    }\r\n                }\r\n\r\n                if (x < key) {\r\n                    return 1;\r\n                } else if (x > key) {\r\n                    return 1;\r\n                } else {\r\n                    // This is the key itself.\r\n                    return -1;\r\n                }\r\n            }\r\n        }\r\n    );\r\n\r\n    return copy;\r\n}\r\n","import styles from 'App.module.scss';\r\nimport { useEffect, useState, createContext } from 'react';\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport useLocalStorageState from 'hooks/useLocalStorageState';\r\n\r\nimport globalArticlesData from 'data/articles.json';\r\nimport { buildFromJSON } from \"components/Article/Article\";\r\n\r\nimport Header from 'pages/Header/Header';\r\nimport Homepage from \"pages/Homepage/Homepage\";\r\nimport Admin from \"pages/Admin/Admin\";\r\n\r\n\r\nexport const ApplicationContext = createContext({});\r\n\r\nfunction App({ api }) {\r\n  const [articlesData, setArticlesData] = useState(globalArticlesData);\r\n  useEffect(() => {\r\n    (async () => setArticlesData(await api.queryForArticles()))();\r\n  }, [api]);\r\n\r\n  const [isAdmin, setIsAdmin] = useLocalStorageState('isAdmin', false);\r\n\r\n  return (\r\n    <ApplicationContext.Provider value={{\r\n      isAdmin: isAdmin,\r\n      setAdminState: setIsAdmin,\r\n    }}>\r\n\r\n      <Header />\r\n\r\n      <main id={styles.main}>\r\n        <Switch>\r\n          <Route exact path='/'>\r\n            <Homepage articlesData={articlesData} />\r\n          </Route>\r\n          <Route exact path='/admin'>\r\n            <Admin\r\n              api={api}\r\n              articlesData={articlesData}\r\n              setArticlesData={setArticlesData}\r\n            />\r\n          </Route>\r\n\r\n          {\r\n            articlesData.articles.map((article) =>\r\n                buildFromJSON({ article, api, articlesData, setArticlesData })\r\n            )\r\n          }\r\n\r\n          <Route path='*'>\r\n            404\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n\r\n      <footer id={styles.footer}>\r\n\r\n      </footer>\r\n      \r\n    </ApplicationContext.Provider >\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter } from 'react-router-dom';\r\n\r\nimport 'index.css';\r\nimport 'styles/global.scss';\r\n\r\nimport { Secrets } from 'secrets';\r\nimport { RecyclopediaApplicationContext } from 'utils/RecyclopediaApplicationContext';\r\n\r\nimport App from 'App';\r\n\r\n\r\n\r\n/*\r\n  This weird wrapping mess is kind of necessary as the connection to mongodb realm/atlas\r\n  takes a noticable amount of time. I'm not entirely convinced it's cause of how I set it up\r\n  considering it's like two documents or something...\r\n\r\n  Something to put into consideration though.\r\n*/\r\n(async function () {\r\n  new RecyclopediaApplicationContext(\r\n    Secrets.RECYCLOPEDIA_APPLICATION_ID,\r\n    function (errored) {\r\n      if (errored) {\r\n        ReactDOM.render(\r\n          <React.StrictMode>\r\n            <p>MongoDB is probably offline. Crap.</p>\r\n          </React.StrictMode>,\r\n          document.getElementById('root')\r\n        );\r\n      } else {\r\n        ReactDOM.render(\r\n          <React.StrictMode>\r\n            <BrowserRouter basename='/recyclopedia'>\r\n              <App api={this} />\r\n            </BrowserRouter>\r\n          </React.StrictMode>,\r\n          document.getElementById('root')\r\n        );\r\n      }\r\n    });\r\n\r\n  ReactDOM.render(\r\n    <React.StrictMode>\r\n      <p>Please wait! Loading Recyclopedia...</p>\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n  );\r\n})();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"group\":\"Input_group__17cm4\",\"form-input-label\":\"Input_form-input-label__3XeeE\",\"shrink\":\"Input_shrink__1Ejxt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropOut\":\"NoticeBanner_dropOut__27qEQ\",\"dropIn\":\"NoticeBanner_dropIn__QXAik\",\"drop-in\":\"NoticeBanner_drop-in__1yqzX\",\"main\":\"NoticeBanner_main__2YpUO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"btn\":\"Header_btn__ixp2s\",\"navbar\":\"Header_navbar__1qBL4\",\"logoDiv\":\"Header_logoDiv__3T1yS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchbar\":\"Searchbar_searchbar__2o8go\",\"clearDiv\":\"Searchbar_clearDiv__3C4Bk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"btn\":\"App_btn__226iN\",\"main\":\"App_main__3HmsK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"Article_title__3V4iY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__yxyJm\",\"google\":\"Button_google__4WBul\"};"],"sourceRoot":""}