{"version":3,"sources":["app/adminSlice.ts","app/articlesSlice.ts","app/store.ts","components/UI/Spinner.tsx","utils/search.ts","hooks/useEventListener.ts","components/Searchbar/Searchbar.tsx","pages/Header/Search.tsx","pages/Header/Header.tsx","pages/Homepage/Homepage.tsx","App.tsx","index.tsx","utils/functions.ts","app/hooks.ts","components/Article/Article.module.scss","components/Searchbar/Searchbar.module.scss","pages/Header/Header.module.scss","App.module.scss","pages/Homepage/Homepage.module.scss","secrets.js","components/Article/MarkdownRender.tsx","utils/DOMIntoMarkdown.ts","pages/Header/Search.module.scss"],"names":["LoginType","registerAccount","information","a","databaseApi","application","emailPasswordAuth","registerUser","email","password","loginWith","credentials","Credentials","emailPassword","anonymous","user","undefined","logIn","type","User","Anonymous","applicationUser","loginWithEmailAndPassword","createAsyncThunk","accountDetails","possiblyAdminLoginType","customData","status","Admin","adminSlice","createSlice","name","initialState","loginType","reducers","logout","state","NotLoggedIn","extraReducers","builder","addCase","fulfilled","action","payload","actions","selectSelf","admin","selectLoginType","createDraftSafeSelector","tryToCallWithUser","fn","argument","thunkApi","Error","console","error","rejectWithValue","response","data","initApi","appId","getState","dispatch","App","id","queryForArticles","queryForAllTags","query","functions","getAllArticles","_","getAllTags","migrateArticle","migrationParams","newName","result","deleteArticle","removeArticle","restoreArticle","insertArticle","articleContent","createOrUpdateArticle","articlesSlice","articlesData","articles","recycledArticles","allTags","pending","rejected","slice","logMessage","MessageLogType","General","selectStatus","selectArticlesData","selectAllTags","persistConfig","key","storage","whitelist","rootReducer","combineReducers","articlesReducer","adminReducer","persistedReducer","persistReducer","store","configureStore","reducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","FLUSH","REHYDRATE","PAUSE","PERSIST","PURGE","REGISTER","ignoredPaths","persistor","persistStore","SpinnerDiv","styled","div","Rect","props","color","height","width","num","index","Spinner","Array","map","calculateStringMatchScore","haystack","needle","length","input","onlySpaces","matchScore","validMatch","haystack_index","needle_index","match_score","exact_match","matched","toLowerCase","approximateSearch","entries","entry","filter","sort","entryA","entryB","useEventListener","element","eventType","listener","options","savedListener","useRef","useEffect","current","addEventListener","wrappedListener","e","removeEventListener","Searchbar","isSearchResultsOpened","returnInput","useState","setInput","searchbar","lastTimeTyped","Date","getTime","document","body","preventDefault","focus","className","styles","focused","onFocus","autoFocus","placeholder","ref","value","onChange","target","setTimeout","changeHandler","onBlur","searchbarControl","clear","onClick","renderHoverboxSearch","searchResults","updateSearchResults","searchbarStyle","to","validPageLink","Search","searchFunction","renderFunction","useAppSelector","setSearchResults","searchbarContainerRef","matches","article","Header","useAppDispatch","currentLoginType","header","logoDiv","navbar","menu","links","ArticleShowcase","randomElt","content","articleDisplay","MarkdownRender","searchResult","substr","replaceAll","Homepage","homepage","href","Article","lazy","IndexPage","RecyclingBin","Register","Login","main","exact","path","fallback","currentArticle","inRecycling","draftStatus","InitializingApp","Secrets","RECYCLOPEDIA_APPLICATION_ID","errorScreen","errorImg","loadingScreen","ReactDOM","render","StrictMode","basename","getElementById","originalName","trim","replace","uploadImage","image_name","form_data","FormData","append","requestUrl","IMGBB_KEY","log","fetch","method","res","json","retrieveImageData","imageFile","whenRetrieved","image_file","img","createElement","src","URL","createObjectURL","onload","canvas","canvas_context","getContext","drawImage","imgData","toDataURL","split","dictionaryUpdateKey","dictionary","updateFunction","newDictionary","dictionaryUpdateKeyNested","keys","shallowClone","array","Math","floor","random","classListClear","node","classList","remove","item","classListReplace","classes","classItem","add","voidElementTagNameTable","isVoidElement","root","nodeType","NodeType","Element","elementRoot","elementName","tagName","_selectionStack","selectionStackPush","selection","window","getSelection","topMostSelection","getRangeAt","removeRange","push","selectionStackPop","addRange","pop","message","messageFn","argumentsList","composedMessage","Todo","Note","Warning","warn","optionalParams","useDispatch","useSelector","module","exports","ADMIN_PASSWORD","md","MD","html","breaks","linkify","typographer","renderMarkdown","text","children","dangerouslySetInnerHTML","__html","surrounder","sym","spacesLeft","spacesRight","i","repeat","DivSemanticType","surrounders","renderDivElementIntoMarkdown","semanticType","contains","articleStyles","captionBox","CaptionedImage","Unknown","determineSemanticTypeOfDivElement","imageElement","captionTextContents","rendered_string","textContent","floatLeft","floatCenter","floatRight","renderChildrenOfDomAsMarkdown","from","childNodes","renderElementAsMarkdown","Text","anchorElement","anchorText","anchorLink","Number","inbetween","child","childrenNodes","outerHTML","renderDomAsMarkdown"],"mappings":"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","file":"static/js/main.ea21fc31.chunk.js","sourcesContent":["import { createSlice, createDraftSafeSelector, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { RootState } from \"app/store\";\n\nimport { Credentials } from \"realm-web\";\nimport { databaseApi } from \"app/articlesSlice\";\n\nexport enum LoginType {\n  NotLoggedIn,\n  Anonymous,\n  User,\n  Admin,\n}\n\nexport interface AccountDetails {\n  email: string;\n  password: string;\n}\n\nexport interface LoginAttemptResult {\n  type: LoginType,\n  accountDetails?: AccountDetails,\n}\n\ninterface ApplicationState {\n  loginType: LoginType | null,\n  accountDetails: AccountDetails,\n}\n\nconst initialState: ApplicationState = {\n  loginType: null,\n  accountDetails: {\n    email: \"\",\n    password: \"\",\n  }\n};\n\nexport async function registerAccount(information: AccountDetails) {\n  await databaseApi.application?.emailPasswordAuth.registerUser(information.email, information.password);\n}\n\nexport async function loginWith(information?: AccountDetails) {\n  const credentials = (!information)\n    ? Credentials.anonymous()\n    : Credentials.emailPassword(information.email, information.password);\n\n  let user = undefined;\n  try {\n    user = await databaseApi.application?.logIn(credentials);\n    return { type: LoginType.User, user };\n  } catch (error) {\n    user = await databaseApi.application?.logIn(Credentials.anonymous());\n    return { type: LoginType.Anonymous, user };\n  } finally {\n    databaseApi.applicationUser = user;\n  }\n}\n\nexport const loginWithEmailAndPassword = createAsyncThunk(\n  \"admin/loginWithEmailAndPassword\",\n  async (accountDetails: AccountDetails) => {\n    const { type, user } = await loginWith(accountDetails);\n\n    if (type !== LoginType.Anonymous) {\n      const possiblyAdminLoginType =\n        (user?.customData.status) === \"admin\" ? LoginType.Admin : false;\n      return {\n        accountDetails,\n        type: possiblyAdminLoginType || type,\n      };\n    }\n\n    return { type };\n  }\n);\n\nconst adminSlice = createSlice({\n  name: \"admin\",\n  initialState,\n  reducers: {\n    logout: (state) => {\n      state.loginType = LoginType.NotLoggedIn;\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(\n      loginWithEmailAndPassword.fulfilled,\n      (state, action) => {\n        const payload = action.payload;\n\n        switch (payload.type) {\n        case LoginType.User:\n        case LoginType.Admin:\n          state.accountDetails = payload.accountDetails;\n          state.loginType = payload.type;\n          break;\n\n        default: break;\n        }\n      }\n    );\n  }\n});\n\nexport const {\n  logout\n} = adminSlice.actions;\nexport default adminSlice.reducer;\n\nconst selectSelf = (state: RootState) => state.admin;\n\nexport const selectLoginType = createDraftSafeSelector(\n  selectSelf,\n  (admin) => admin.loginType\n);\n\nexport const selectAccountDetails = createDraftSafeSelector(\n  selectSelf,\n  (admin) => admin.accountDetails\n);","import { createSlice, createAsyncThunk, createDraftSafeSelector } from \"@reduxjs/toolkit\";\nimport { RootState } from \"app/store\";\nimport { loginWithEmailAndPassword } from \"app/adminSlice\";\n\nimport { App, User, Credentials } from \"realm-web\";\nimport { MessageLogType, logMessage } from \"utils/functions\";\n\nexport interface Article {\n  name: string;\n  content: string;\n  draftStatus: boolean;\n  tags?: string[];\n}\n\nexport interface RecycledArticle extends Article {\n  pendingDaysUntilDeletion: number;\n}\n\nexport interface ArticlesData {\n  articles: Article[];\n  recycledArticles: RecycledArticle[];\n}\n\nexport type ArticlesDataProperties = {\n  articlesData: ArticlesData;\n};\n\nexport const databaseApi: {\n  application: App | undefined | null;\n  applicationUser: User | undefined | null;\n} = {\n  application: null,\n  applicationUser: null\n};\n\nconst initialState: {\n    status: \"idle\" | \"loading\" | \"succeed\" | \"failed\";\n    articlesData: ArticlesData;\n    allTags: string[];\n} = {\n  status: \"idle\",\n  articlesData: {\n    articles: [],\n    recycledArticles: [],\n  },\n  allTags: []\n};\n\n// @ts-ignore\nfunction tryToCallWithUser(fn) {\n// @ts-ignore\n  return async function(argument, thunkApi) {\n    try {\n      if (databaseApi.applicationUser) {\n        return await fn(databaseApi.applicationUser, argument, thunkApi);\n      } else {\n        throw new Error(\"No user? This is some real bad news\");\n      }\n    } catch (error) {\n      console.error(\"Call with user error: \", error);\n      return thunkApi.rejectWithValue(error.response.data);\n    }\n  };\n}\n\nexport const initApi = createAsyncThunk(\n  \"articles/initApi\",\n  async (appId: string, { getState, dispatch, rejectWithValue }) => {\n    const state = getState() as RootState;\n    try {\n      databaseApi.application = new App({ id: appId });\n      const accountDetails = state.admin.accountDetails;\n            \n      await dispatch(loginWithEmailAndPassword(accountDetails));\n      dispatch(queryForArticles(undefined));\n      dispatch(queryForAllTags(undefined));\n    } catch (error) {\n      console.error(\"Failed to login because: \", error);\n      return rejectWithValue(error.response.data);\n    }\n  }\n);\n\nexport const queryForArticles = createAsyncThunk(\n  \"articles/queryForArticles\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function(user: Realm.User, query?: any, thunkApi: any) {\n      return await user.functions.getAllArticles();\n    }\n  )\n);\n\nexport const queryForAllTags = createAsyncThunk(\n  \"articles/queryForAllTags\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function(user: Realm.User, _: any, thunkApi: any) {\n      return await user.functions.getAllTags();\n    }\n  )\n);\n\ninterface MigrationParameters {\n    name: string,\n    newName: string,\n}\n\n/*\n  It annoys me that these single thunks require so much boiler plate...\n*/\nexport const migrateArticle = createAsyncThunk(\n  \"articles/migrateArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function(user: Realm.User, migrationParams: MigrationParameters, {dispatch}) {\n      const result = await user.functions.migrateArticle(migrationParams.name, migrationParams.newName);\n      dispatch(queryForArticles(undefined));\n      return result;\n    }\n  )\n);\n\nexport const deleteArticle = createAsyncThunk(\n  \"articles/deleteArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function(user: Realm.User, name: string, {dispatch}) {\n      await user.functions.removeArticle(name);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nexport const restoreArticle = createAsyncThunk(\n  \"articles/restoreArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function(user: Realm.User, name: string, {dispatch}) {\n      await user.functions.restoreArticle(name);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nexport const insertArticle = createAsyncThunk(\n  \"articles/insertArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function(user: Realm.User, articleContent: Article, {dispatch}) {\n      await user.functions.createOrUpdateArticle(articleContent);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nconst articlesSlice = createSlice({\n  name: \"api\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(\n      initApi.pending,\n      (state) => {\n        state.status = \"loading\";\n      }\n    ).addCase(\n      initApi.rejected,\n      (state) => {\n        state.status = \"failed\";\n      }\n    ).addCase(\n      initApi.fulfilled,\n      (state) => {\n        state.status = \"succeed\";\n      }\n    ).addCase(\n      queryForArticles.fulfilled,\n      (state, action) => {\n        state.articlesData = action.payload;\n      }\n    ).addCase(\n      queryForAllTags.fulfilled,\n      (state, action) => {\n        state.allTags = action.payload.slice(0);\n        logMessage(MessageLogType.General, \"Loaded Tags: \", state.allTags);\n      }\n    );\n  }\n});\n\nexport default articlesSlice.reducer;\nconst selectSelf = (state: RootState) => state.articles;\n\n// shouldn't it be possible to programmatically generate these instead\n// of copy and paste? Like building the export dictionary manually?\nexport const selectStatus = createDraftSafeSelector(\n  selectSelf,\n  (articles) => articles.status\n);\n\nexport const selectArticlesData = createDraftSafeSelector(\n  selectSelf,\n  (articles) => articles.articlesData\n);\n\n\nexport const selectAllTags = createDraftSafeSelector(\n  selectSelf,\n  (articles) => {\n    return articles.allTags.slice(0);\n  }\n);\n","import { configureStore, ThunkAction, Action, combineReducers } from \"@reduxjs/toolkit\";\nimport {\n  persistStore, persistReducer,\n  FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER\n} from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\";\n\nimport articlesReducer from \"app/articlesSlice\";\nimport adminReducer from \"app/adminSlice\";\n\n\nconst persistConfig = {\n  key: \"root\",\n  storage,\n  whitelist: [\"admin\"]\n};\n\nconst rootReducer = combineReducers({\n  articles: articlesReducer,\n  admin: adminReducer\n});\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer);\n\n/*\nNOTE(jerry):\n\nPersist store, will not work unless we store additional information, and I only have enough\nknowledge to know how to turn off the persistant store and understand that it is a persistant\nstore.\n\nWe just need to store the currently logged user credentials, and we can go from there. Basically\non app reinitialization we need to try to login using the existing credentials.\n\nSo now we don't really have a true or false anymore...\n*/\n\nexport const store = configureStore({\n  reducer: persistedReducer,\n  middleware: (getDefaultMiddleware) => getDefaultMiddleware({\n    serializableCheck: {\n      ignoredActions: [\n        FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER,\n        \"articles/queryForArticles/fulfilled\"\n      ],\n      ignoredPaths: [\"articles.articlesData\"]\n    }\n  })\n});\n\nexport const persistor = persistStore(store);\n\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","import styled from \"styled-components\";\n\nconst SpinnerDiv = styled.div`\n  @keyframes sk-stretchdelay {\n    0%, 40%, 100% { \n      transform: scaleY(0.4);\n    }  20% { \n      transform: scaleY(1.0);\n    }\n  }\n`;\n\nconst Rect = styled.div<{\n  num: number,\n  color: string,\n  height: number,\n  width: number,\n  index: number;\n}>`\n  display: inline-block;\n  background-color: ${props => props.color};\n  height: ${props => props.height}px;\n  width: ${props => props.width}px;\n  margin: 0 ${props => props.width / 3}px;\n\n  animation: sk-stretchdelay ${props => 0.7 + props.num / 10}s infinite ease-in-out;\n  animation-delay: -${props => 1.1 - props.index / 10}s;\n`;\n\nexport default function Spinner(\n  {\n    num = 5,\n    height = 50,\n    width = 6,\n    color = \"white\"\n  }: {\n    num?: number,\n    color?: string,\n    height?: number,\n    width?: number;\n  }\n) {\n\n  return (\n    <SpinnerDiv>\n      {[...Array(num)].map((_, index) => (\n        <Rect\n          key={index}\n          index={index}\n          num={num}\n          color={color}\n          height={height}\n          width={width}\n        />\n      ))}\n    </SpinnerDiv>\n  );\n}\n","import { Article } from \"app/articlesSlice\";\n\ninterface StringMatchResult {\n  matchScore: number,\n  validMatch: boolean,\n}\n\nfunction onlySpaces(input: string) {\n  let index = 0;\n\n  while (index < input.length)  {\n    if (input[index] !== \" \") {\n      return false;\n    }\n    index++;\n  }\n\n  return true;\n}\n\nfunction calculateStringMatchScore(haystack: string, needle: string): StringMatchResult {\n  if (needle.length === 0 || onlySpaces(needle)) return {matchScore: -9999, validMatch: false};\n\n  let haystack_index = 0;\n  let needle_index = 0;\n\n  let match_score = 0;\n  let exact_match = (haystack.length === needle.length);\n  let matched = 0;\n\n  while (haystack_index < haystack.length && needle_index < needle.length) {\n    while (haystack[haystack_index]?.toLowerCase() === needle[needle_index]?.toLowerCase()) {\n      if (haystack[haystack_index] === needle[needle_index]) {\n        match_score += 10;\n      }\n\n      if (haystack_index === needle_index) {\n        match_score += 15;\n      } else {\n        match_score += 2;\n        exact_match = false;\n      }\n\n      matched++;\n      needle_index++;\n    }\n\n    match_score -= 1;\n    haystack_index++;\n  }\n\n  if (needle_index >= needle.length) {\n    match_score += 10;\n    if (exact_match) {\n      match_score += 20;\n    }\n  }\n\n  if (matched === 0) {\n    match_score -= 50;\n  }\n\n  return {matchScore: match_score, validMatch: matched > 0};\n}\n\nexport default function approximateSearch(entries: Article[], key: string) { \n  // I wish there were transducers like in Clojure. This might be hella expensive.\n  const result = entries\n    .map((entry) => {\n      return {\n        entry: entry,\n        matchScore: calculateStringMatchScore(entry.name, key)\n      };\n    })\n    .filter((entry) => entry.matchScore.validMatch)\n    .sort((entryA, entryB) => entryB.matchScore.matchScore - entryA.matchScore.matchScore)\n    .map((entry) => entry.entry);\n  return result;\n}\n","import { useEffect, useRef } from \"react\";\n\nconst useEventListener = <\n  E extends Element | Document | Window,\n  T extends keyof ElementEventMap | keyof DocumentEventMap | keyof WindowEventMap,\n  >(\n    element: E,\n    eventType: T | string,\n    listener: (\n      e:\n        T extends keyof ElementEventMap ? ElementEventMap[T]\n        : T extends keyof DocumentEventMap ? DocumentEventMap[T]\n        : T extends keyof WindowEventMap ? WindowEventMap[T]\n        : Event\n    ) => void,\n    options?: boolean | AddEventListenerOptions\n\n  ) => {\n\n  const savedListener = useRef(listener);\n  useEffect(() => {\n    savedListener.current = listener;\n  }, [listener]);\n\n  useEffect(() => {\n    if (!element || !element.addEventListener) return;\n\n    const wrappedListener: typeof savedListener.current = (e) => savedListener.current(e);\n    element.addEventListener(eventType, wrappedListener as EventListener, options);\n\n    return () => element.removeEventListener(eventType, wrappedListener as EventListener, options);\n  }, [element, eventType, options]);\n};\n\nexport default useEventListener;","import styles from \"./Searchbar.module.scss\";\nimport useEventListener from \"hooks/useEventListener\";\nimport { useState, useRef } from \"react\";\n\n\nexport default function Searchbar({\n  isSearchResultsOpened,\n  returnInput\n}: {\n  isSearchResultsOpened: boolean;\n  returnInput: (input: string) => void;\n}) {\n  const [input, setInput] = useState(\"\");\n  const searchbar = useRef<null | HTMLInputElement>(null);\n\n  const openSearchResultsDelay = 500;\n  const lastTimeTyped = useRef(new Date().getTime());\n\n  useEventListener(document.body, \"keydown\", (e) => {\n    if (e.key === \"/\") {\n      e.preventDefault();\n      searchbar.current?.focus();\n    }\n  });\n\n  const changeHandler = (input: string) => {\n    lastTimeTyped.current = new Date().getTime();\n\n    setTimeout(() => {\n      if (new Date().getTime() - lastTimeTyped.current >= openSearchResultsDelay) {\n        returnInput(input);\n      }\n    }, openSearchResultsDelay);\n  };\n\n  return (\n    <div\n      className={`\n        ${styles.searchbar}\n        ${(searchbar && isSearchResultsOpened) ? styles.focused : \"\"}\n      `}\n      onFocus={() => {\n        // The callback is necessary because when focus happens, input is yet to update\n        setInput(input => {\n          returnInput(input);\n          return input;\n        });\n      }}\n    >\n      <input\n        autoFocus\n        type='text'\n        placeholder='Search'\n        ref={searchbar}\n        value={input}\n        onChange={(e) => {\n          setInput(e.target.value);\n          changeHandler(e.target.value);\n        }}\n        onBlur={() => setInput(\"\")}\n      />\n      {(input) && (\n        <div id={styles.searchbarControl}>\n          <div\n            id={styles.clear}\n            className='material-icons'\n            onClick={() => {\n              setInput(\"\");\n              searchbar.current && searchbar.current.focus();\n            }}\n          >\n            clear\n          </div>\n          {/* <div\n            id={styles.search}\n            className='material-icons'\n          >\n            search\n          </div> */}\n        </div>\n      )}\n    </div>\n  );\n}\n","import styles from \"pages/Header/Search.module.scss\";\nimport searchbarStyle from \"components/Searchbar/Searchbar.module.scss\";\nimport { useState, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { useAppSelector } from \"app/hooks\";\nimport { selectArticlesData, Article } from \"app/articlesSlice\";\n\nimport { validPageLink } from \"utils/functions\";\nimport MarkdownRender from \"components/Article/MarkdownRender\";\n\nimport Searchbar from \"components/Searchbar/Searchbar\";\n\ntype SearchFunction = \n  (inputArticles: Article[], input: string) => Article[];\ntype RenderSearchResultFunction =\n  (searchResults: Article[], updateSearchResults: (x: typeof searchResults) => void) => JSX.Element | null;\n\nexport function renderHoverboxSearch(searchResults: Article[], updateSearchResults: (x: typeof searchResults) => void) {\n  return (searchResults.length > 0) ? (\n    <div className={searchbarStyle.searchResults}>\n      {\n        searchResults.slice(0, 5).map(({ name }) => (\n          <Link\n            key={name}\n            to={validPageLink(name)}\n            onClick={() => updateSearchResults([])}\n          >\n            {name}\n          </Link>))\n      }\n    </div>\n  ) : null;\n}\n\ninterface SearchProperties {\n  searchFunction: SearchFunction,\n  renderFunction: RenderSearchResultFunction,\n}\n\nfunction Search({searchFunction, renderFunction}: SearchProperties) {\n  const articlesData = useAppSelector(selectArticlesData);\n  const [searchResults, setSearchResults] = useState<Article[]>([]);\n\n  function returnInputCallback(input: string) {\n    setSearchResults(\n      input ? searchFunction(\n        articlesData.articles.map((article) => article),\n        input\n      ) : []\n    );\n  }\n\n  const searchbarContainerRef = useRef<HTMLDivElement>(null);\n\n  return (\n    <div className={styles.searchbar}\n      ref={searchbarContainerRef}\n      onBlur={() => {\n        // This is necessary because, afaik, react and javascript doesn't have a way to check focus-within is lost or not, something like onBlurWithin : (\n        // ISSUE: when you click on a link, the search results box does not auto close\n        if (!searchbarContainerRef.current?.matches(\":focus-within\")) {\n          setSearchResults([]);\n        }\n      }}\n    >\n      <Searchbar\n        isSearchResultsOpened={(searchResults.length !== 0)}\n        returnInput={returnInputCallback}\n      />\n      {renderFunction(searchResults, setSearchResults)}\n    </div>\n  );\n}\n\nexport default Search;\n","import styles from \"pages/Header/Header.module.scss\";\nimport { Link } from \"react-router-dom\";\n\nimport { useAppDispatch, useAppSelector } from \"app/hooks\";\nimport { LoginType, logout, selectLoginType } from \"app/adminSlice\";\n\nimport approximateSearch from \"utils/search\";\nimport Search, { renderHoverboxSearch } from \"pages/Header/Search\";\n\n\nconst Header = () => {\n  const dispatch = useAppDispatch();\n  const currentLoginType = useAppSelector(selectLoginType);\n\n  return (\n    <header id={styles.header}>\n      <Link to=\"/\">\n        <div id={styles.logoDiv}></div>\n      </Link>\n      <Search\n        searchFunction={approximateSearch}\n        renderFunction={renderHoverboxSearch}\n      />\n      <nav id={styles.navbar}>\n        <button className={\"material-icons \" + styles.menu}>\n          menu\n        </button>\n        <button className={styles.links}>\n          <Link to='/index'>Index</Link>\n          {(\n            currentLoginType != LoginType.Anonymous &&\n            currentLoginType != LoginType.NotLoggedIn\n          ) ? (\n              <>\n                {\n                  (currentLoginType === LoginType.Admin) ?\n                    (\n                      <>\n                        <Link to=\"/admin/recycling_bin\">\n                      Recycling Bin\n                        </Link>\n                        <Link to=\"/admin\">\n                      Create New Article\n                        </Link>\n                      </>) :\n                    <></>\n                }\n                <button\n                  onClick={() => {\n                    dispatch(logout());\n                  }}\n                >\n                  Logout\n                </button>\n              </>\n            ) : (\n              <>\n                <Link to=\"/register\">Register</Link>\n                <Link to=\"/login\">Login</Link>\n              </>\n            )}\n        </button>\n      </nav>\n    </header >\n  );\n};\n\nexport default Header;\n","import styles from \"pages/Homepage/Homepage.module.scss\";\nimport { Link } from \"react-router-dom\";\n\nimport { validPageLink, randomElt } from \"utils/functions\";\nimport MarkdownRender from \"components/Article/MarkdownRender\";\n\n\nimport { ArticlesDataProperties } from \"app/articlesSlice\";\n\nfunction ArticleShowcase({\n  articlesData: { articles }\n}: ArticlesDataProperties\n) {\n  const { name, content } = (articles.length)\n    ? randomElt(articles)\n    : { name: \"no article name\", content: \"no articles\" };\n\n  return (\n    <>\n      <h2>Featured Article</h2>\n      <div className={styles.articleDisplay}>\n        <p>TODO what is the best way to determine a featured article?</p>\n        <p>Honestly, that might have to be manually audited since that depends on a lot of things.</p>\n      </div>\n\n      <Link to={validPageLink(name)}>\n        <h2>Random Article</h2>\n      </Link>\n      <div className={styles.articleDisplay}>\n        <h2>{name}</h2>\n        <MarkdownRender className={styles.searchResult}>\n          {`${content.substr(0, 800).replaceAll(/(@@.*)|(@@.*@@)/g, \"\")}`}\n        </MarkdownRender>\n      </div>\n    </>\n  );\n}\n\nfunction Homepage({ articlesData }: ArticlesDataProperties) {\n  return (\n    <div id={styles.homepage}>\n      <h1>Welcome to Recyclopedia</h1>\n      <p>\n        Recyclopedia is a freely accessible wiki designed to be a complete source for\n        environmentally friendly actions. While it is primarily meant to be a comprehensive\n        source of ways to recycle items appropriately. It may also contain other methods of\n        sustaining an environmentally friendly lifestyle.\n      </p>\n      <p>This is developed by <a href=\"https://www.projectenv.org/\">The Environment Project</a></p>\n      <ArticleShowcase articlesData={articlesData}></ArticleShowcase>\n    </div>\n  );\n}\n\nexport default Homepage;","import styles from \"App.module.scss\";\nimport { lazy, Suspense, useEffect } from \"react\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\n\nimport { useAppDispatch, useAppSelector } from \"app/hooks\";\nimport { initApi, selectStatus, selectArticlesData } from \"app/articlesSlice\";\nimport { selectLoginType, LoginType } from \"app/adminSlice\";\n\nimport { Secrets } from \"secrets\";\nimport { validPageLink } from \"utils/functions\";\n\nimport Spinner from \"components/UI/Spinner\";\n\nimport Header from \"pages/Header/Header\";\nimport Homepage from \"pages/Homepage/Homepage\";\n\nconst Article = lazy(() => import(\"components/Article/Article\"));\nconst IndexPage = lazy(() => import(\"pages/Index/IndexPage\"));\nconst RecyclingBin = lazy(() => import(\"pages/RecyclingBin/RecyclingBin\"));\nconst Admin = lazy(() => import(\"pages/Admin/Admin\"));\nconst Register = lazy(() => import(\"pages/Admin/Register\"));\nconst Login = lazy(() => import(\"pages/Admin/Login\"));\n\nfunction App() {\n  const articlesData = useAppSelector(selectArticlesData);\n  const currentLoginType = useAppSelector(selectLoginType);\n\n  return (\n    <>\n      <Header />\n\n      <main id={styles.main}>\n        <Switch>\n          <Route exact path='/'>\n            <Homepage articlesData={articlesData} />\n          </Route>\n\n          <Suspense fallback={\n            <p>Please wait! Loading Recyclopedia...</p>\n          }>\n            <Route exact path='/index'>\n              <IndexPage />\n            </Route>\n            <Route path=\"/login\">\n              <Login />\n            </Route>\n            <Route path=\"/register\">\n              <Register />\n            </Route>\n\n            <Route exact path='/admin'>\n              {\n                (currentLoginType === LoginType.Admin)\n                  ? <Admin currentArticle={undefined} />\n                  : <Redirect to='/' />\n              }\n            </Route>\n            <Route exact path='/admin/recycling_bin/'>\n              <RecyclingBin />\n            </Route>\n\n            {\n              (currentLoginType === LoginType.Admin)\n                ? articlesData.recycledArticles.map((article) =>\n                  <Route key={article.name} exact path={\"/admin/recycling_bin\"+validPageLink(article.name)}>\n                    <Article inRecycling={true} article={article} />\n                  </Route>)\n                : <></>\n            }\n\n            {((currentLoginType === LoginType.Admin)\n              ? articlesData.articles\n              : articlesData.articles.filter((article) => !article.draftStatus)\n            ).map((article) =>\n              <Route key={article.name} exact path={validPageLink(article.name)}>\n                <Article inRecycling={false} article={article} />\n              </Route>\n            )}\n          </Suspense>\n\n          <Route path='*'>404</Route>\n        </Switch>\n      </main>\n    </>\n  );\n}\n\nfunction InitializingApp() {\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(initApi(Secrets.RECYCLOPEDIA_APPLICATION_ID));\n  }, [dispatch]);\n\n  const status = useAppSelector(selectStatus);\n\n  if (status === \"failed\")\n    return (\n      <div id={styles.errorScreen} >\n        <div className={styles.errorImg} />\n        <p>MongoDB is probably offline. Crap...</p>\n      </div>\n    );\n\n  if (status === \"succeed\")\n    return <App />;\n\n  return (\n    <div id={styles.loadingScreen} >\n      <Spinner color=\"black\" />\n      <p>Please wait! Loading Recyclopedia...</p>\n    </div>\n  );\n}\n\nexport default InitializingApp;\n\n\n/*\n   For obvious reasons getting ALL the articles is kind of dumb. I believe it\n   would be better if we fetched articles on the 404 path.\n\n   Basically we don't generate the routes here. Rather we kind of hook them up on demand.\n\n   So the index is still generated with links, and only as much as we need to display a page.\n\n   Basically that means I have to do something like:\n\n   bucketSize  = the amount of things we consider to be on a \"page\"\n   bucketIndex = the \"page\"\n   getArticleInformationPageful(bucketSize: number, bucketIndex: number);\n\n   IE:\n   It's like:\n   getAllArticles().slice(bucketIndex * bucketSize, (bucketIndex+1) * bucketSize);\n   but since it's on the server side, it reduces the load to send all of them.\n\n   Then in the wildcard route we simply try to make the article component request the article\n   in the URL. If it can't do it, then we just display normal 404.\n\n   We only have 1 million free api requests from MongoDB so this might ironically be worse since\n   each article will take a request from the API (even though it uses less storage space on the\n   client side).\n */\n","import \"index.scss\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter } from \"react-router-dom\";\n\nimport { PersistGate } from \"redux-persist/integration/react\";\nimport { Provider } from \"react-redux\";\nimport { store, persistor } from \"app/store\";\n\nimport App from \"App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <PersistGate persistor={persistor}>\n        <BrowserRouter basename='/recyclopedia'>\n          <App />\n        </BrowserRouter>\n      </PersistGate>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);","import { useEffect } from \"react\";\nimport { NodeType } from \"utils/DOMIntoMarkdown\";\nimport { Secrets } from \"secrets\";\n\nexport const validPageLink = (originalName: string) => `/${originalName.toLowerCase().trim().replace(/ +/g, \"_\")}`;\n\nexport async function uploadImage(image_name: string) {\n  const form_data = new FormData();\n  form_data.append(\"image\", image_name);\n\n  const expirationValue = 600;\n  const requestUrl = `https://api.imgbb.com/1/upload?expiration${expirationValue}&key=${Secrets.IMGBB_KEY}`;\n  console.log(requestUrl);\n  const res = await fetch(requestUrl, { method: \"POST\", body: form_data, });\n  console.log(\"waiting...\");\n\n  return await res.json();\n}\n\n// for now this is an alias.\ntype Base64String = string;\ntype RetrievedImageCallback = (f: Base64String) => void;\nexport async function retrieveImageData(\n  imageFile: File,\n  whenRetrieved: RetrievedImageCallback\n) {\n  const image_file = imageFile;\n  const img = document.createElement(\"img\");\n  img.src = URL.createObjectURL(image_file);\n  console.log(\"attempting to load: \", image_file);\n  img.onload = async function () {\n    const canvas = document.createElement(\"canvas\");\n    const canvas_context = canvas.getContext(\"2d\");\n    if (canvas_context) {\n      canvas.width = img.width;\n      canvas.height = img.height;\n\n      canvas_context.drawImage(img, 0, 0);\n      const imgData = canvas.toDataURL().split(\",\")[1];\n      console.log(\"image data retrieved\");\n      whenRetrieved(imgData);\n    } else {\n      console.log(\"null canvas?\");\n    }\n  };\n}\n\n/*\n  These functions are legitimately supposed to be any. These are supposed to operate indiscriminately\n  on any type of dictionary like object.\n\n  Javascript allows you to use anything as a key technically for dictionaries,\n  but this is as close I can get to that I suppose...\n */\n\nexport function dictionaryUpdateKey(\n  dictionary: { [key: string]: any; },\n  key: any,\n  updateFunction: (f: unknown) => unknown\n) {\n  const newDictionary = { ...dictionary };\n  newDictionary[key] = updateFunction(dictionary[key]);\n  return newDictionary;\n}\n\nexport function dictionaryUpdateKeyNested(\n  dictionary: { [key: string]: any; },\n  keys: any[],\n  updateFunction: (f: unknown) => unknown\n) {\n  if (keys.length > 1) {\n    const shallowClone = { ...dictionary };\n    shallowClone[keys[0]] =\n      dictionaryUpdateKeyNested(shallowClone[keys[0]], keys.slice(1), updateFunction);\n    return shallowClone;\n  }\n\n  // returns\n  return dictionaryUpdateKey(dictionary, keys[0], updateFunction);\n}\n\nexport const useTimeout = (callback: () => void, delay: number) => {\n  useEffect(() => {\n    const timer = setTimeout(() => callback(), delay);\n    return () => clearTimeout(timer);\n  }, [delay, callback]);\n};\n\nexport function randomElt(array: any[]) {\n  return array[Math.floor(Math.random() * array.length)];\n}\n\n// dom helps?\nexport function classListClear(node: Element) {\n  while (node.classList.length > 0) {\n    node.classList.remove(node.classList.item(0) || \"\");\n  }\n}\n\nexport function classListReplace(node: Element, classes: string[]) {\n  classListClear(node);\n  console.log(node.classList);\n  for (const classItem of classes) {\n    node.classList.add(classItem);\n  }\n  console.log(node.classList);\n}\n\n// http://w3c.github.io/html-reference/syntax.html\nconst voidElementTagNameTable = [\n  \"BR\", \"BASE\", \"AREA\", \"COL\", \"COMMAND\",\n  \"EMBED\", \"HR\", \"IMG\", \"INPUT\", \"KEYGEN\",\n  \"LINK\", \"META\", \"PARAM\", \"SOURCE\", \"TRACK\", \"WBR\"\n];\n\nexport function isVoidElement(root: Node) {\n  if (root.nodeType === NodeType.Element) {\n    const elementRoot = root as Element;\n\n    for (const elementName of voidElementTagNameTable) {\n      if (elementRoot.tagName === elementName) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// push and pop the current selection stack\n// this is mostly to keep the selection consistent for stuff...\n// that needs to temporarily break focus or whatever...\nconst _selectionStack: Range[] = [];\nexport function selectionStackPush() {\n  const selection = window.getSelection();\n  const topMostSelection = selection?.getRangeAt(0);\n\n  if (topMostSelection) {\n    selection?.removeRange(topMostSelection);\n    _selectionStack.push(topMostSelection);\n  }\n}\n\nexport function selectionStackPop() {\n  if (_selectionStack.length) {\n    const selection = window.getSelection();\n    selection?.addRange(_selectionStack.pop() as Range);\n  }\n}\n\nfunction isDevelopment() {\n  if (process.env.NODE_ENV || process.env.NODE_ENV === \"development\") {\n    return true;\n  }\n\n  return false;\n}\n\n/*\n  This thing is just useful for having messages that don't show up in production\n  and also allow for more noticable TODOs because probably no one reads comments, but\n  I assure you that we will read the console.\n\n  Although in practice we may only just use General/Warning/Error as just console wrappers\n  to avoid spamming in the console.\n*/\nexport enum MessageLogType {\n  General,\n  Warning,\n  Error,\n  Todo,\n  Note,\n}\n\nexport function logMessage(type: MessageLogType, message?: any, ...optionalParams: any[]) {\n  if (isDevelopment()) {\n    let messageFn = console.log;\n    const argumentsList = [];\n    let composedMessage = \"\";\n\n    switch (type) {\n    case MessageLogType.Todo:\n    case MessageLogType.Note:\n    case MessageLogType.General:\n      if (type === MessageLogType.Todo) {\n        composedMessage += \"%cTODO%c\";\n        argumentsList.push(\"background-color: black; color: orange; font-size: 1.2em;\", \"unset: all;\");\n      } else if (type === MessageLogType.Note) {\n        composedMessage += \"%cNOTE:%c\";\n        argumentsList.push(\"background-color: black; color: lightgreen; font-size: 1.2em;\", \"unset: all;\");\n      } else {\n        composedMessage += \"%cINFO: %c\";\n        argumentsList.push(\"background-color: black; color: white; font-size: 1.2em;\", \"unset: all;\");\n      }\n      messageFn = console.log;\n      break;\n    case MessageLogType.Warning:\n      composedMessage += \"%cWARNING%c\";\n      argumentsList.push(\"background-color: black; color: white; font-size: 1.2em;\", \"unset: all;\");\n      messageFn = console.warn;\n      break;\n    case MessageLogType.Error:\n      messageFn = console.error;\n      composedMessage += \"%cERROR!%c\";\n      argumentsList.push(\"background-color: black; color: red; font-size: 1.2em;\", \"unset: all;\");\n      break;\n    }\n\n    composedMessage += (message || \"\");\n    for (const element of optionalParams) {\n      argumentsList.push(element);\n    }\n\n    messageFn(composedMessage, argumentsList);\n  }\n}","import { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\nimport type { RootState, AppDispatch } from \"./store\";\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"articleControls\":\"Article_articleControls__95Evd\",\"deleteBtn\":\"Article_deleteBtn__1sdHc\",\"title\":\"Article_title__G_BGG\",\"article\":\"Article_article__3AVYo\",\"tag_view\":\"Article_tag_view__3RpFW\",\"floatCenter\":\"Article_floatCenter__1RUh-\",\"floatLeft\":\"Article_floatLeft__2IJ3p\",\"floatRight\":\"Article_floatRight__3pqbI\",\"noWrapAroundText\":\"Article_noWrapAroundText__2dudq\",\"captionBox\":\"Article_captionBox__1tZ2s\",\"captionImagePreview\":\"Article_captionImagePreview__3saqr\",\"captionBoxInner\":\"Article_captionBoxInner__ZRS_C\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchbar\":\"Searchbar_searchbar__2jLRV\",\"focused\":\"Searchbar_focused__39Jjj\",\"searchbarControl\":\"Searchbar_searchbarControl__3mGMh\",\"clear\":\"Searchbar_clear__3uANO\",\"search\":\"Searchbar_search__1ch6H\",\"searchResults\":\"Searchbar_searchResults__18l6O\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__2fJbI\",\"links\":\"Header_links__Bc9bG\",\"menu\":\"Header_menu__TfZLm\",\"navbar\":\"Header_navbar__2ot4g\",\"logoDiv\":\"Header_logoDiv__1Hf0g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loadingScreen\":\"App_loadingScreen__J9ldS\",\"errorScreen\":\"App_errorScreen__3OgjQ\",\"errorImg\":\"App_errorImg__3nX-t\",\"main\":\"App_main__2Jffb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"homepage\":\"Homepage_homepage__2XFyl\",\"articleDisplay\":\"Homepage_articleDisplay__33qDe\"};","/*\n  Store context sensitive information here\n */\nexport const Secrets = {\n  RECYCLOPEDIA_APPLICATION_ID: \"recyclopedia-api-uuuus\",\n  ADMIN_PASSWORD: \"tonyisugly\",\n  IMGBB_KEY: \"5eba0537206ecc76b4a505e866868853\"\n};\n","import MD from \"markdown-it\";\nconst md = MD({\n  html: true,\n  breaks: true,\n  linkify: true,\n  typographer: true,\n});\n\nexport const renderMarkdown = (text: string) => md.render(text);\n\nfunction MarkdownRender({\n  className, children\n}: {\n  className: string; children: string;\n}) {\n  return (<div\n    className={className}\n    dangerouslySetInnerHTML={{ __html: renderMarkdown(children) }}>\n  </div>);\n}\n\nexport default MarkdownRender;","/*\n    Inhouse DOM to Markdown interpreter.\n\n    This is primarily designed to take the DOM Soup from contenteditable\n    on firefox.\n\n    It'll probably work good enough with a properly formed DOM, but don't blame\n    me if something explodes.\n*/\nimport articleStyles from \"components/Article/Article.module.scss\";\n\nfunction surrounder(sym: string) {\n  return function (content: typeof sym) {\n    let spacesLeft = 0;\n    let spacesRight = 0;\n    for (let i = 0; i < content.length; ++i) {\n      if (content[i] !== \" \") {\n        spacesLeft = i - 1;\n        break;\n      }\n    }\n    for (let i = content.length - 1; i > 0; --i) {\n      if (content[i] !== \" \") {\n        break;\n      }\n      spacesRight++;\n    }\n    return `${spacesLeft > 0 ? \" \".repeat(spacesLeft) : \"\"}${sym}${content.trim()}${sym}${spacesRight > 0 ? \" \".repeat(spacesRight) : \"\"}`;\n  };\n}\n\nconst surrounders = {\n  \"B\": surrounder(\"**\"),\n  \"STRONG\": surrounder(\"**\"),\n  \"I\": surrounder(\"_\"),\n  \"EM\": surrounder(\"_\"),\n  \"U\": surrounder(\"__\"),\n};\n// @ts-ignore\nconst safe_call = (fn) => (...rest) => (fn) ? fn(...rest) : rest[0];\n/*\nNOTE(jerry):\n\nI'm not a particular fan of this since this is definitely very scrappy. It does not know how to\nproperly handle nested lists, although without extra modification the RichTextEditor doesn't allow you\nto do nested lists trivially anyways... So hopefully it's not much of a disaster (just store the current indent\nlevel and then do it based off of whatever markdown seems to recognize a list as.)\n\nMost other normal elements are handled fine, it's really just the lists I'm concerned about.\n\nThis is entirely recursive, and because it's recursive it loses some information that may be useful for\ncleaner and probably easier rendering...\n*/\n\nexport enum NodeType {\n  Element = 1,\n  Attribute = 2,\n  Text = 3,\n  CDataSection = 4,\n  ProcessingInformation = 5,\n  Comment = 6,\n  Document = 7,\n  DocumentType = 8,\n  DocumentFragment = 9,\n}\n\n// we're going to use divs as semantic types.\nenum DivSemanticType {\n  Unknown,\n  CaptionedImage,\n  Article\n}\n\nfunction determineSemanticTypeOfDivElement(root: HTMLDivElement): DivSemanticType {\n  const classList = root.classList;\n\n  if (root.classList.contains(articleStyles.captionBox)) {\n    return DivSemanticType.CaptionedImage;\n  } else if (root.classList.contains(articleStyles.article)) {\n    return DivSemanticType.Article;\n  }\n\n  return DivSemanticType.Unknown;\n}\n\nfunction renderDivElementIntoMarkdown(root: HTMLDivElement): string {\n  const semanticType = determineSemanticTypeOfDivElement(root);\n  console.log(semanticType);\n\n  switch (semanticType) {\n  case DivSemanticType.CaptionedImage: {\n    const imageElement = root.children[0] as HTMLImageElement;\n    const captionTextElement = root.children[1] as HTMLDivElement;\n    const captionTextContents = captionTextElement.children[0] as HTMLParagraphElement;\n\n    let rendered_string = \"\";\n    rendered_string += `src = '${imageElement.src}' |` ;\n    rendered_string += `width = ${imageElement.width} |` ;\n    rendered_string += `height = ${imageElement.height} |` ;\n    rendered_string += `caption = '${captionTextContents.textContent?.trim()}'`;\n\n    if (root.classList.contains(articleStyles.floatLeft)) {\n      rendered_string += \"| floatingMethod = floatLeft\";\n    } else if (root.classList.contains(articleStyles.floatCenter)) {\n      rendered_string += \"| floatingMethod = floatCenter\";\n    } else if (root.classList.contains(articleStyles.floatRight)) {\n      rendered_string += \"| floatingMethod = floatRight\";\n    }\n\n    return \"@@ \" + rendered_string + \" @@\";\n  } break;\n\n  case DivSemanticType.Article: {\n    return renderChildrenOfDomAsMarkdown(root);\n  } break;\n\n  case DivSemanticType.Unknown:\n  default:\n    console.error(\"This is unusual... Unknown Div structure?\");\n    return \"\";\n  }\n}\n\nfunction renderChildrenOfDomAsMarkdown(root: HTMLElement): string {\n  let result = \"\";\n\n  for (const child of Array.from(root.childNodes)) {\n    const asHTMLElementChild = child as HTMLElement;\n\n    result += renderElementAsMarkdown(asHTMLElementChild);\n  }\n\n  return result;\n}\n\nfunction renderElementAsMarkdown(root: HTMLElement): string {\n  if (root.nodeType === NodeType.Text) {\n    return (root.textContent || \"\");\n  }\n\n  switch (root.tagName) {\n  case \"DIV\": {\n    return renderDivElementIntoMarkdown(root as HTMLDivElement); \n  } break;\n\n  /*\n  TODO(jerry):\n  I do not attempt to parse additional decoration here.\n  */\n  case \"A\": {\n    const anchorElement = root as HTMLAnchorElement;\n    const anchorText = anchorElement.textContent; \n    const anchorLink = anchorElement.href;\n\n    return `[${anchorText}](${anchorLink})`;\n  } break;\n\n  case \"IMG\": {\n    const imageElement = root as HTMLImageElement; \n\n    let rendered_string = \"\";\n    rendered_string += `src = '${imageElement.src}' |` ;\n    rendered_string += `width = ${imageElement.width} |` ;\n    rendered_string += `height = ${imageElement.height}` ;\n\n    if (imageElement.classList.contains(articleStyles.floatLeft)) {\n      rendered_string += \"| floatingMethod = floatLeft\";\n    } else if (imageElement.classList.contains(articleStyles.floatCenter)) {\n      rendered_string += \"| floatingMethod = floatCenter\";\n    } else if (imageElement.classList.contains(articleStyles.floatRight)) {\n      rendered_string += \"| floatingMethod = floatRight\";\n    }\n\n    return \"@@ \" + rendered_string + \" @@\\n\";\n  } break;\n\n  case \"H6\": case \"H5\": case \"H4\": case \"H3\": case \"H2\": case \"H1\": {\n    const headerElement = root as HTMLHeadingElement;\n    return \"\\n\" + \"#\".repeat(Number(root.tagName[1])) + \" \" + renderChildrenOfDomAsMarkdown(root) + \"\\n\";\n  } break;\n\n  case \"B\": case \"U\": case \"I\": case \"STRONG\": case \"EM\": {\n    const inbetween = renderChildrenOfDomAsMarkdown(root);\n    console.log(\"TWEEN\", inbetween);\n    if (inbetween !== \"\") {\n      return safe_call(surrounders[root.tagName])(inbetween);\n    }\n\n    // return \"<p><br/></p>\";\n  } break;\n\n  case \"OL\": {\n    const childrenNodes = Array.from(root.childNodes);\n    let result = \"\";\n\n    let i = 1;\n    for (const child of childrenNodes) {\n      if (child.nodeType === NodeType.Element) {\n        result += `${i++}. ` + renderChildrenOfDomAsMarkdown(child as HTMLElement) + \"\\n\";\n      }\n    }\n\n    return result+\"\\n\";\n  } break;\n\n  case \"UL\": {\n    const childrenNodes = Array.from(root.childNodes);\n    let result = \"\";\n\n    for (const child of childrenNodes) {\n      if (child.nodeType === NodeType.Element) {\n        result += \"- \" + renderChildrenOfDomAsMarkdown(child as HTMLElement) + \"\\n\";\n      }\n    }\n\n    return result+\"\\n\";\n  } break;\n\n  /*\n  ALERT(jerry):\n\n  This seems to be the most problematic element as it can never convert 1-1 from anything we give it... Most elements will parent themselves to\n  the paragraph which makes it iffy af.\n\n  IE: The structural that's generated by a contenteditable element... Is really confusing and not easy to figure out... I may have to do way more manual work\n  than I was ever expecting...\n  */\n  case \"P\": {\n    /*\n    NOTE(jerry):\n\n    Why doesn't everyone just agree on what shit should be generated?\n    This has only been tested on Firefox. We'll have to find this out later...\n    */\n    const childrenNodes = Array.from(root.children);\n\n    // As I set the defaultSeparator to use <p>\n    // the only way I can get consistent appearance with the actual article\n    // is to literally just output it... It looks dumb.\n    // This is also not 100% correct... But it may pass inspection.\n    if (childrenNodes.length === 1 && childrenNodes[0].tagName === \"BR\") {\n      return root.outerHTML + \"\\n\";\n    }\n\n    return renderChildrenOfDomAsMarkdown(root) + \"\\n\\n\";\n  } break;\n\n  default: {\n    console.error(\"Unhandled case: \", root.tagName);\n  } break;\n  }\n\n  return \"\";\n}\n\nexport function renderDomAsMarkdown(root: HTMLElement): string {\n  return renderElementAsMarkdown(root);\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchbar\":\"Search_searchbar__1jRdR\"};"],"sourceRoot":""}