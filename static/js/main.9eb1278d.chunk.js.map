{"version":3,"sources":["app/articlesSlice.ts","app/store.ts","components/UI/Spinner.tsx","utils/search.ts","hooks/useEventListener.ts","components/Searchbar/Searchbar.tsx","pages/Header/Search.tsx","components/UI/ResponsiveNav.tsx","pages/Header/Header.tsx","pages/Footer/Footer.tsx","pages/Homepage/Homepage.tsx","App.tsx","index.tsx","app/hooks.ts","utils/functions.ts","components/UI/ResponsiveNav.module.scss","components/Article/Article.module.scss","components/Searchbar/Searchbar.module.scss","pages/Footer/Footer.module.scss","App.module.scss","secrets.js","pages/Header/Header.module.scss","components/UI/Button.module.scss","pages/Homepage/Homepage.module.scss","components/UI/Button.tsx","app/adminSlice.ts","components/Article/MarkdownRender.tsx","utils/DOMIntoMarkdown.ts","components/Article/Banner.tsx"],"names":["databaseApi","application","applicationUser","tryToCallWithUser","fn","argument","thunkApi","a","Error","console","error","rejectWithValue","response","data","initApi","createAsyncThunk","appId","getState","dispatch","state","App","id","accountDetails","admin","loginWithEmailAndPassword","queryForArticles","undefined","queryForAllTags","user","query","functions","getAllArticles","articles","_","getAllTags","migrateArticle","migrationParams","name","newName","result","deleteArticle","removeArticle","restoreArticle","insertArticle","articleContent","createOrUpdateArticle","setFeaturedArticle","articleTitle","articlesSlice","createSlice","initialState","status","articlesData","featuredArticle","recycledArticles","allTags","reducers","extraReducers","builder","addCase","pending","rejected","fulfilled","action","payload","slice","logMessage","MessageLogType","General","VoteType","selectSelf","selectStatus","createDraftSafeSelector","selectArticlesData","selectNameOfFeaturedArticle","buildCommentDraft","loginType","comment","commentContents","content","createdAt","Date","votes","LoginType","Anonymous","NotLoggedIn","email","avatar","addComment","articleName","completedComment","replies","_1","voteTypeToString","voteType","Like","Dislike","articleVote","commentVote","target","getCommentsOfArticle","_argument","comments","fetchedComments","readArticlesFromLoginType","useAppSelector","selectLoginType","Admin","newArticleSet","filter","article","draftStatus","selectAllTags","persistConfig","key","storage","whitelist","rootReducer","combineReducers","articlesReducer","adminReducer","persistedReducer","persistReducer","store","configureStore","reducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","FLUSH","REHYDRATE","PAUSE","PERSIST","PURGE","REGISTER","ignoredPaths","persistor","persistStore","SpinnerDiv","styled","div","Rect","props","color","height","width","num","index","Spinner","Array","map","calculateStringMatchScore","haystack","needle","length","input","onlySpaces","matchScore","validMatch","haystack_index","needle_index","match_score","exact_match","matched","toLowerCase","approximateSearch","entries","entry","sort","entryA","entryB","useEventListener","element","eventType","listener","options","savedListener","useRef","useEffect","current","addEventListener","wrappedListener","e","removeEventListener","Searchbar","isSearchResultsOpened","returnInput","useState","setInput","searchbar","lastTimeTyped","getTime","document","body","preventDefault","focus","className","cn","styles","focused","onFocus","autoFocus","type","placeholder","ref","value","onChange","setTimeout","changeHandler","searchbarControl","clear","onClick","renderHoverboxSearch","searchResults","updateSearchResults","to","validPageLink","Search","searchFunction","renderFunction","setSearchResults","searchbarContainerRef","onBlur","matches","ResponsiveNav","children","sidebarRef","shrunk","setShrunk","sidebarOpened","setSidebarOpened","handleResize","sidebar","navbar","parentElement","getBoundingClientRect","window","closeSidebar","overlay","classList","add","slideOut","contains","remove","nav","menuBtn","opened","currentTarget","closeBtn","Header","useAppDispatch","currentLoginType","header","logoDiv","logout","Footer","socialIcoColor","footer","links","socialLinks","bgColor","url","pageLinks","rel","href","Button","about","getFullYear","ArticlePreview","previewTitle","articleDisplay","bannerImage","Banner","MarkdownRender","searchResult","substr","replaceAll","ArticleShowcase","randomArticle","randomElt","featuredArticleName","find","Homepage","homepage","Article","lazy","IndexPage","RecyclingBin","Account","main","exact","path","fallback","currentArticle","inRecycling","InitializingApp","Secrets","RECYCLOPEDIA_APPLICATION_ID","errorScreen","errorImg","loadingScreen","ReactDOM","render","StrictMode","basename","getElementById","useDispatch","useSelector","originalName","trim","replace","uploadImage","image_name","form_data","FormData","append","requestUrl","IMGBB_KEY","log","fetch","method","res","json","retrieveImageData","imageFile","whenRetrieved","image_file","img","createElement","src","URL","createObjectURL","onload","canvas","canvas_context","getContext","drawImage","imgData","toDataURL","split","dictionaryUpdateKey","dictionary","updateFunction","newDictionary","dictionaryUpdateKeyNested","keys","shallowClone","array","Math","floor","random","classListClear","node","item","classListReplace","classes","classItem","voidElementTagNameTable","isVoidElement","root","nodeType","NodeType","Element","elementRoot","elementName","tagName","_selectionStack","selectionStackPush","selection","getSelection","topMostSelection","getRangeAt","removeRange","push","selectionStackPop","addRange","pop","message","messageFn","argumentsList","composedMessage","Todo","Note","Warning","warn","optionalParams","module","exports","ADMIN_PASSWORD","styledAs","button","default","password","accountCustomData","registerAccount","information","emailPasswordAuth","registerUser","loginWith","credentials","Credentials","emailPassword","anonymous","logIn","User","possiblyAdminLoginType","customData","adminSlice","actions","selectAccountDetails","md","MD","html","breaks","linkify","typographer","renderMarkdown","text","dangerouslySetInnerHTML","__html","surrounder","sym","spacesLeft","spacesRight","i","repeat","DivSemanticType","surrounders","renderDivElementIntoMarkdown","semanticType","articleStyles","captionBox","CaptionedImage","Unknown","determineSemanticTypeOfDivElement","imageElement","captionTextContents","rendered_string","textContent","floatLeft","floatCenter","floatRight","renderChildrenOfDomAsMarkdown","from","childNodes","renderElementAsMarkdown","Text","anchorElement","anchorText","anchorLink","Number","inbetween","child","childrenNodes","outerHTML","renderDomAsMarkdown","bannerContainer"],"mappings":"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","file":"static/js/main.9eb1278d.chunk.js","sourcesContent":["/*\n  NOTE(jerry):\n    Okay, now most of the stuff we care about is done. I need to now start tightening down on security.\n    There's some holes we can't avoid (merely just because we have this code downloaded onto the browser), however\n    I do not authenticate any of the data we send over, so I'll have to work on that later.\n\n    Thankfully all of these functions are user/login authenticated with permissions, so only invalid data can brick\n    things, and you still need to be logged in properly to break stuff.\n\n    setFeaturedArticle is the only one I'm aware of with bad data.\n*/\n\nimport { CommentModel, TopLevelCommentModel } from \"components/Comment/Comment\";\n\nimport { createSlice, createAsyncThunk, createDraftSafeSelector } from \"@reduxjs/toolkit\";\nimport { RootState } from \"app/store\";\nimport { AccountDetails, loginWithEmailAndPassword } from \"app/adminSlice\";\n\nimport { selectAccountCustomData, selectAccountDetails, selectLoginType, LoginType } from \"app/adminSlice\";\nimport { useAppSelector } from \"app/hooks\";\n\nimport { App, User, Credentials } from \"realm-web\";\nimport { MessageLogType, logMessage } from \"utils/functions\";\n\ntype MongoDBRealmUserIdType = string;\nexport interface Vote {\n  userId: MongoDBRealmUserIdType;\n  // MongoDB does not know about typescript types\n  type: \"like\" | \"dislike\" | \"none\";\n}\n// COPIED FROM SOMEWHERE ELSE. TO BE REMOVED\n\nexport interface Article {\n  name: string;\n  content: string;\n  bannerImage?: string;\n  dateCreated: Date;\n  dateModified?: Date;\n  draftStatus: boolean;\n\n  votes: Vote[];\n  tags?: string[];\n}\n\n// This is a partial version of the article\n// with optional fields. This is because we won't necessarily\n// be filling out all the fields.\nexport interface ArticleDraft {\n  name: string;\n  content: string;\n  dateCreated?: Date;\n  tags?: string[];\n}\n\nexport interface RecycledArticle extends Article {\n  pendingDaysUntilDeletion: number;\n}\n\nexport interface ArticlesData {\n  featuredArticle: string | null,\n  articles: Article[];\n  recycledArticles: RecycledArticle[];\n}\n\nexport type ArticlesDataProperties = {\n  articlesData: ArticlesData;\n};\n\nexport const databaseApi: {\n  application: App | undefined | null;\n  applicationUser: User | undefined | null;\n} = {\n  application: null,\n  applicationUser: null\n};\n\nconst initialState: {\n  status: \"idle\" | \"loading\" | \"succeed\" | \"failed\";\n  articlesData: ArticlesData;\n  allTags: string[];\n} = {\n  status: \"idle\",\n  articlesData: {\n    featuredArticle: null,\n    articles: [],\n    recycledArticles: [],\n  },\n  allTags: []\n};\n\n// @ts-ignore\nfunction tryToCallWithUser(fn) {\n  // @ts-ignore\n  return async function (argument, thunkApi) {\n    try {\n      if (databaseApi.applicationUser) {\n        return await fn(databaseApi.applicationUser, argument, thunkApi);\n      } else {\n        throw new Error(\"No user? This is some real bad news\");\n      }\n    } catch (error) {\n      console.error(\"Call with user error: \", error);\n      return thunkApi.rejectWithValue(error.response.data);\n    }\n  };\n}\n\nexport const initApi = createAsyncThunk(\n  \"articles/initApi\",\n  async (appId: string, { getState, dispatch, rejectWithValue }) => {\n    const state = getState() as RootState;\n    try {\n      databaseApi.application = new App({ id: appId });\n      const accountDetails = state.admin.accountDetails;\n\n      await dispatch(loginWithEmailAndPassword(accountDetails));\n      dispatch(queryForArticles(undefined));\n      dispatch(queryForAllTags(undefined));\n    } catch (error) {\n      console.error(\"Failed to login because: \", error);\n      return rejectWithValue(error.response.data);\n    }\n  }\n);\n\nexport const queryForArticles = createAsyncThunk(\n  \"articles/queryForArticles\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, query?: any, thunkApi: any) {\n      // TODO(jerry): dummy, until we actually add all dates for articles\n      const articles = await user.functions.getAllArticles();\n      return articles;\n    }\n  )\n);\n\nexport const queryForAllTags = createAsyncThunk(\n  \"articles/queryForAllTags\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, _: any, thunkApi: any) {\n      return await user.functions.getAllTags();\n    }\n  )\n);\n\ninterface MigrationParameters {\n  name: string,\n  newName: string,\n}\n\n/*\n  It annoys me that these single thunks require so much boiler plate...\n*/\nexport const migrateArticle = createAsyncThunk(\n  \"articles/migrateArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, migrationParams: MigrationParameters, { dispatch }) {\n      const result = await user.functions.migrateArticle(migrationParams.name, migrationParams.newName);\n      dispatch(queryForArticles(undefined));\n      return result;\n    }\n  )\n);\n\nexport const deleteArticle = createAsyncThunk(\n  \"articles/deleteArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, name: string, { dispatch }) {\n      await user.functions.removeArticle(name);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nexport const restoreArticle = createAsyncThunk(\n  \"articles/restoreArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, name: string, { dispatch }) {\n      await user.functions.restoreArticle(name);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nexport const insertArticle = createAsyncThunk(\n  \"articles/insertArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, articleContent: Article, { dispatch }) {\n      await user.functions.createOrUpdateArticle(articleContent);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nexport const setFeaturedArticle = createAsyncThunk(\n  \"articles/setFeaturedArticle\",\n  tryToCallWithUser(\n    // @ts-ignore\n    async function (user: Realm.User, articleTitle: string | null, { dispatch }) {\n      await user.functions.setFeaturedArticle(articleTitle);\n      dispatch(queryForArticles(undefined));\n    }\n  )\n);\n\nconst articlesSlice = createSlice({\n  name: \"api\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(\n      initApi.pending,\n      (state) => {\n        state.status = \"loading\";\n      }\n    ).addCase(\n      initApi.rejected,\n      (state) => {\n        state.status = \"failed\";\n      }\n    ).addCase(\n      initApi.fulfilled,\n      (state) => {\n        state.status = \"succeed\";\n      }\n    ).addCase(\n      queryForArticles.fulfilled,\n      (state, action) => {\n        state.articlesData = action.payload;\n      }\n    ).addCase(\n      queryForAllTags.fulfilled,\n      (state, action) => {\n        state.allTags = action.payload.slice(0);\n        logMessage(MessageLogType.General, \"Loaded Tags: \", state.allTags);\n      }\n    );\n  }\n});\n\nexport default articlesSlice.reducer;\nconst selectSelf = (state: RootState) => state.articles;\n\n// shouldn't it be possible to programmatically generate these instead\n// of copy and paste? Like building the export dictionary manually?\nexport const selectStatus = createDraftSafeSelector(\n  selectSelf, (articles) => articles.status\n);\n\nexport const selectArticlesData = createDraftSafeSelector(\n  selectSelf, (articles) => articles.articlesData\n);\n\nexport const selectNameOfFeaturedArticle = createDraftSafeSelector(\n  selectSelf, (articles) => articles.articlesData.featuredArticle\n);\n\n// implicitly uses the state of the logged-in user!\nexport function buildCommentDraft(loginType: LoginType, accountDetails: AccountDetails, comment: string) {\n  const currentDate = new Date();\n\n  const commentContents = {\n    content: comment,\n    createdAt: currentDate,\n    votes: [],\n  };\n\n  const commentDraft: CommentModel =\n    (loginType === LoginType.Anonymous || loginType === LoginType.NotLoggedIn)\n      ? commentContents\n      : {\n        ...commentContents,\n        user: {\n          name: accountDetails.email,\n          // comments should not really have avatars in the future.\n          avatar: \"https://lh6.googleusercontent.com/-f9MhM40YFzc/AAAAAAAAAAI/AAAAAAABjbo/iG_SORRy0I4/photo.jpg\",\n        }\n      };\n\n  return commentDraft;\n}\n\nexport async function addComment(loginType: LoginType, accountDetails: AccountDetails, articleName: string, comment: string) {\n  const completedComment = {\n    ...buildCommentDraft(loginType, accountDetails, comment),\n    replies: []\n  };\n\n  await tryToCallWithUser(\n    async function (user: Realm.User, _: any, _1: any) {\n      await user.functions.addComment(articleName, completedComment);\n    }\n  )(undefined, {});\n}\n\nexport async function deleteComment(articleName: string, commentId: number) {\n  /*\n    As of writing this, this function does not exist!\n    remove this when it does.\n  */\n  alert(\"This function is a shim and does not work yet!\");\n  await tryToCallWithUser(\n    async function (user: Realm.User, _: any, _1: any) {\n      await user.functions.removeComment(articleName, commentId);\n    }\n  )(undefined, {});\n}\n\n// parentId:\n// will have to be a more special type of id to prevent against weird issues\n// when deleting. This is not done yet. (some sort of GUID) basically.\nexport async function replyToComment(loginType: LoginType, accountDetails: AccountDetails, articleName: string, parentId: number, comment: string) {\n  const completedComment = buildCommentDraft(loginType, accountDetails, comment);\n\n  await tryToCallWithUser(\n    async function (user: Realm.User, _: any, _1: any) {\n      await user.functions.replyToComment(articleName, parentId, completedComment);\n    }\n  )(undefined, {});\n}\n\n// this one will need to check based on the logged in user.\n// to determine whether we should revote.\nexport enum VoteType {\n  Like,\n  Dislike\n}\n\nexport type ArticleVoteTarget = string;\nexport interface VoteTarget {\n  id: number,\n  // replies should also be GUIDed somehow.\n  replyId?: number,\n}\n\n// To be as quick as possible, we will ignorantly just vote ignorantly\n// without associating votes. We can use localStorage to emulate what I'm requesting\n// but for obvious reasons localStorage is pretty easy to do vote fraud with.\n// and I'm quite a fan of democracy so let's not try to fake it, for now let's just not do it.\ntype VoteTypeString = \"like\" | \"dislike\" | \"unknown\";\nfunction voteTypeToString(voteType: VoteType): VoteTypeString {\n  switch (voteType) {\n    case VoteType.Like:\n      return \"like\";\n    case VoteType.Dislike:\n      return \"dislike\";\n    default:\n      return \"unknown\";\n  }\n}\nexport async function articleVote(loginType: LoginType, articleName: string, voteType: VoteType) {\n  if (loginType === LoginType.Anonymous || loginType === LoginType.NotLoggedIn)\n    return;\n\n  await tryToCallWithUser(\n    async function (user: Realm.User, _: any, _1: any) {\n      await user.functions.articleVote(articleName, voteTypeToString(voteType), user.id);\n    }\n  )(undefined, {});\n}\nexport async function commentVote(loginType: LoginType, articleName: string, voteType: VoteType, target: VoteTarget) {\n  if (loginType === LoginType.Anonymous || loginType === LoginType.NotLoggedIn)\n    return;\n\n  await tryToCallWithUser(\n    async function (user: Realm.User, _: any, _1: any) {\n      await user.functions.commentVote(articleName, voteTypeToString(voteType), target, user.id);\n    }\n  )(undefined, {});\n}\n\nexport async function getCommentsOfArticle(name: string) {\n  // tryToCallWithUser was supposed to reduce the redundancy for reducers\n  // so this looks weird.\n  const fetchedComments = await tryToCallWithUser(\n    async function (user: Realm.User, _argument: any, _: any) {\n      const comments = await user.functions.getCommentsOfArticle(name);\n      return comments;\n    })(undefined, undefined);\n\n  if (fetchedComments) {\n    return fetchedComments;\n  } else {\n    return [];\n  }\n}\n\nexport function readArticlesFromLoginType(): ArticlesData {\n  const loginType = useAppSelector(selectLoginType);\n  const articlesData = useAppSelector(selectArticlesData);\n\n  if (loginType === LoginType.Admin) {\n    return articlesData;\n  } else {\n    const newArticleSet =\n      articlesData.articles.filter((article) => !article.draftStatus);\n    return {\n      ...articlesData,\n      articles: newArticleSet,\n    };\n  }\n}\n\nexport const selectAllTags = createDraftSafeSelector(\n  selectSelf,\n  (articles) => {\n    return articles.allTags.slice(0);\n  }\n);\n","import { configureStore, ThunkAction, Action, combineReducers } from \"@reduxjs/toolkit\";\nimport {\n  persistStore, persistReducer,\n  FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER\n} from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\";\n\nimport articlesReducer from \"app/articlesSlice\";\nimport adminReducer from \"app/adminSlice\";\n\n\nconst persistConfig = {\n  key: \"root\",\n  storage,\n  whitelist: [\"admin\"]\n};\n\nconst rootReducer = combineReducers({\n  articles: articlesReducer,\n  admin: adminReducer\n});\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer);\n\n/*\nNOTE(jerry):\n\nPersist store, will not work unless we store additional information, and I only have enough\nknowledge to know how to turn off the persistant store and understand that it is a persistant\nstore.\n\nWe just need to store the currently logged user credentials, and we can go from there. Basically\non app reinitialization we need to try to login using the existing credentials.\n\nSo now we don't really have a true or false anymore...\n*/\n\nexport const store = configureStore({\n  reducer: persistedReducer,\n  middleware: (getDefaultMiddleware) => getDefaultMiddleware({\n    serializableCheck: {\n      ignoredActions: [\n        FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER,\n        \"articles/queryForArticles/fulfilled\"\n      ],\n      ignoredPaths: [\"articles.articlesData\"]\n    }\n  })\n});\n\nexport const persistor = persistStore(store);\n\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","import styled from \"styled-components\";\n\n\nconst SpinnerDiv = styled.div`\n  @keyframes sk-stretchdelay {\n    0%, 40%, 100% { \n      transform: scaleY(0.4);\n    }  20% { \n      transform: scaleY(1.0);\n    }\n  }\n`;\n\nconst Rect = styled.div<{\n  num: number,\n  color: string,\n  height: number,\n  width: number,\n  index: number;\n}>`\n  display: inline-block;\n  background-color: ${props => props.color};\n  height: ${props => props.height}px;\n  width: ${props => props.width}px;\n  margin: 0 ${props => props.width / 3}px;\n\n  animation: sk-stretchdelay ${props => 0.7 + props.num / 10}s infinite ease-in-out;\n  animation-delay: -${props => 1.1 - props.index / 10}s;\n`;\n\nexport default function Spinner(\n  {\n    num = 5,\n    height = 50,\n    width = 6,\n    color = \"white\"\n  }: {\n    num?: number,\n    color?: string,\n    height?: number,\n    width?: number;\n  }\n) {\n\n  return (\n    <SpinnerDiv>\n      {[...Array(num)].map((_, index) => (\n        <Rect\n          key={index}\n          index={index}\n          num={num}\n          color={color}\n          height={height}\n          width={width}\n        />\n      ))}\n    </SpinnerDiv>\n  );\n}\n","import { Article } from \"app/articlesSlice\";\n\ninterface StringMatchResult {\n  matchScore: number,\n  validMatch: boolean,\n}\n\nfunction onlySpaces(input: string) {\n  let index = 0;\n\n  while (index < input.length)  {\n    if (input[index] !== \" \") {\n      return false;\n    }\n    index++;\n  }\n\n  return true;\n}\n\nfunction calculateStringMatchScore(haystack: string, needle: string): StringMatchResult {\n  if (needle.length === 0 || onlySpaces(needle)) return {matchScore: -9999, validMatch: false};\n\n  let haystack_index = 0;\n  let needle_index = 0;\n\n  let match_score = 0;\n  let exact_match = (haystack.length === needle.length);\n  let matched = 0;\n\n  while (haystack_index < haystack.length && needle_index < needle.length) {\n    while (haystack[haystack_index]?.toLowerCase() === needle[needle_index]?.toLowerCase()) {\n      if (haystack[haystack_index] === needle[needle_index]) {\n        match_score += 10;\n      }\n\n      if (haystack_index === needle_index) {\n        match_score += 15;\n      } else {\n        match_score += 2;\n        exact_match = false;\n      }\n\n      matched++;\n      needle_index++;\n    }\n\n    match_score -= 1;\n    haystack_index++;\n  }\n\n  if (needle_index >= needle.length) {\n    match_score += 10;\n    if (exact_match) {\n      match_score += 20;\n    }\n  }\n\n  if (matched === 0) {\n    match_score -= 50;\n  }\n\n  return {matchScore: match_score, validMatch: matched > 0};\n}\n\nexport default function approximateSearch(entries: Article[], key: string) { \n  // I wish there were transducers like in Clojure. This might be hella expensive.\n  const result = entries\n    .map((entry) => {\n      return {\n        entry: entry,\n        matchScore: calculateStringMatchScore(entry.name, key)\n      };\n    })\n    .filter((entry) => entry.matchScore.validMatch)\n    .sort((entryA, entryB) => entryB.matchScore.matchScore - entryA.matchScore.matchScore)\n    .map((entry) => entry.entry);\n  return result;\n}\n","import { useEffect, useRef } from \"react\";\n\nconst useEventListener = <\n  E extends Element | Document | Window,\n  T extends keyof ElementEventMap | keyof DocumentEventMap | keyof WindowEventMap,\n  >(\n    element: E,\n    eventType: T | string,\n    listener: (\n      e:\n        T extends keyof ElementEventMap ? ElementEventMap[T]\n        : T extends keyof DocumentEventMap ? DocumentEventMap[T]\n        : T extends keyof WindowEventMap ? WindowEventMap[T]\n        : Event\n    ) => void,\n    options?: boolean | AddEventListenerOptions\n\n  ) => {\n\n  const savedListener = useRef(listener);\n  useEffect(() => {\n    savedListener.current = listener;\n  }, [listener]);\n\n  useEffect(() => {\n    if (!element || !element.addEventListener) return;\n\n    const wrappedListener: typeof savedListener.current = (e) => savedListener.current(e);\n    element.addEventListener(eventType, wrappedListener as EventListener, options);\n\n    return () => element.removeEventListener(eventType, wrappedListener as EventListener, options);\n  }, [element, eventType, options]);\n};\n\nexport default useEventListener;","import styles from \"./Searchbar.module.scss\";\nimport { useState, useRef } from \"react\";\nimport cn from \"classnames\";\n\nimport useEventListener from \"hooks/useEventListener\";\n\n\nexport default function Searchbar({\n  isSearchResultsOpened,\n  returnInput\n}: {\n  isSearchResultsOpened: boolean;\n  returnInput: (input: string) => void;\n}) {\n  const [input, setInput] = useState(\"\");\n  const searchbar = useRef<null | HTMLInputElement>(null);\n\n  const openSearchResultsDelay = 500;\n  const lastTimeTyped = useRef(new Date().getTime());\n\n  useEventListener(document.body, \"keydown\", (e) => {\n    if (e.key === \"/\") {\n      e.preventDefault();\n      searchbar.current?.focus();\n    }\n  });\n\n  const changeHandler = (input: string) => {\n    lastTimeTyped.current = new Date().getTime();\n\n    setTimeout(() => {\n      if (new Date().getTime() - lastTimeTyped.current >= openSearchResultsDelay) {\n        returnInput(input);\n      }\n    }, openSearchResultsDelay);\n  };\n\n  return (\n    <div\n      className={cn(styles.searchbar, {\n        [styles.focused]: (searchbar && isSearchResultsOpened)\n      })}\n      onFocus={() => {\n        // The callback is necessary because when focus happens, input is yet to update\n        setInput(input => {\n          returnInput(input);\n          return input;\n        });\n      }}\n    >\n      <input\n        autoFocus\n        type='text'\n        placeholder='Search'\n        ref={searchbar}\n        value={input}\n        onChange={(e) => {\n          setInput(e.target.value);\n          changeHandler(e.target.value);\n        }}\n      />\n      {(input) && (\n        <div id={styles.searchbarControl}>\n          <div\n            id={styles.clear}\n            className='material-icons'\n            onClick={() => {\n              setInput(\"\");\n              searchbar.current && searchbar.current.focus();\n            }}\n          >\n            clear\n          </div>\n          {/* <div\n            id={styles.search}\n            className='material-icons'\n          >\n            search\n          </div> */}\n        </div>\n      )}\n    </div>\n  );\n}\n","import styles from \"components/Searchbar/Searchbar.module.scss\";\nimport { useState, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { Article, readArticlesFromLoginType } from \"app/articlesSlice\";\nimport { validPageLink } from \"utils/functions\";\nimport Searchbar from \"components/Searchbar/Searchbar\";\n\n\ntype SearchFunction =\n  (inputArticles: Article[], input: string) => Article[];\ntype RenderSearchResultFunction =\n  (searchResults: Article[], updateSearchResults: (x: typeof searchResults) => void) => JSX.Element | null;\n\nexport function renderHoverboxSearch(searchResults: Article[], updateSearchResults: (x: typeof searchResults) => void) {\n  return (searchResults.length > 0) ? (\n    <div className={styles.searchResults}>\n      {\n        searchResults.slice(0, 5).map(({ name }) => (\n          <Link\n            key={name}\n            to={validPageLink(name)}\n            onClick={() => updateSearchResults([])}\n          >\n            {name}\n          </Link>))\n      }\n    </div>\n  ) : null;\n}\n\ninterface SearchProperties {\n  searchFunction: SearchFunction,\n  renderFunction: RenderSearchResultFunction,\n}\n\nfunction Search({ searchFunction, renderFunction }: SearchProperties) {\n  const articlesData = readArticlesFromLoginType();\n  const [searchResults, setSearchResults] = useState<Article[]>([]);\n\n  function returnInputCallback(input: string) {\n    setSearchResults(\n      input ?\n        searchFunction(articlesData.articles, input) :\n        []\n    );\n  }\n\n  const searchbarContainerRef = useRef<HTMLDivElement>(null);\n\n  return (\n    <div\n      ref={searchbarContainerRef}\n      onBlur={() => {\n        if (!searchbarContainerRef.current?.matches(\":focus-within\")) {\n          setSearchResults([]);\n        }\n      }}\n    >\n      <Searchbar\n        isSearchResultsOpened={(searchResults.length !== 0)}\n        returnInput={returnInputCallback}\n      />\n      {renderFunction(searchResults, setSearchResults)}\n    </div>\n  );\n}\n\nexport default Search;\n","import styles from \"./ResponsiveNav.module.scss\";\nimport { useEffect, useRef, useState } from \"react\";\nimport cn from \"classnames\";\n\nimport useEventListener from \"hooks/useEventListener\";\n\n\nfunction ResponsiveNav({\n  children,\n  className,\n  ...props\n}: {\n  children: React.ReactNode,\n} & React.HTMLAttributes<HTMLElement>\n) {\n  const sidebarRef = useRef<HTMLDivElement>(null);\n  const [shrunk, setShrunk] = useState(true);\n  const [sidebarOpened, setSidebarOpened] = useState(false);\n\n  const handleResize = () => {\n    const sidebar = sidebarRef.current;\n    const navbar = sidebar?.parentElement?.parentElement;\n    if (!sidebar || !navbar) return;\n\n    if (sidebar.getBoundingClientRect().width >= navbar.getBoundingClientRect().width) {\n      setShrunk(true);\n    } else {\n      setShrunk(false);\n      // If the sidebar is too small, there's no reason to technically have it open\n      // you could do an && on the bottom, but it's probably not expected behavior I expect\n      // since it's kind of jarring to have it suddenly open lol.\n      setSidebarOpened(false);\n    }\n  };\n\n  useEffect(() => {\n    handleResize();\n  }, [children]);\n  // Children is added to the dependency array so that when the user login/logout, navbar will resize in response\n\n  useEventListener(window, \"resize\", () => {\n    handleResize();\n  });\n\n  const closeSidebar = () => {\n    const sidebar = sidebarRef.current;\n    const overlay = sidebar?.parentElement as HTMLDivElement;\n    if (!sidebar || !overlay) return;\n\n    overlay.classList.add(styles.slideOut);\n    overlay.addEventListener(\"animationend\", () => {\n      if (overlay.classList.contains(styles.slideOut)) {\n        overlay.classList.remove(styles.slideOut);\n        setSidebarOpened(false);\n      }\n    });\n  };\n\n  return (\n    <nav\n      className={cn(styles.nav, className)}\n      {...props}\n    >\n      {(shrunk) && (\n        <button\n          className={cn(\"material-icons\", styles.menuBtn)}\n          onClick={() =>\n            setSidebarOpened(true)\n          }\n        >\n          menu\n        </button>\n      )}\n      <div\n        className={cn(styles.overlay, {\n          [styles.shrunk]: shrunk,\n          [styles.opened]: sidebarOpened\n        })}\n        onClick={(e) => {\n          if (e.target !== e.currentTarget) return;\n          closeSidebar();\n        }}\n      >\n        <div\n          ref={sidebarRef}\n          className={styles.sidebar}\n        >\n          {(sidebarOpened) && (\n            <button\n              className={cn(\"material-icons\", styles.closeBtn)}\n              onClick={() => closeSidebar()}\n            >\n              close\n            </button>\n          )}\n          {children}\n        </div>\n      </div>\n    </nav >\n  );\n}\n\nexport default ResponsiveNav;\n","import styles from \"pages/Header/Header.module.scss\";\nimport { Link } from \"react-router-dom\";\n\nimport { useAppDispatch, useAppSelector } from \"app/hooks\";\nimport { LoginType, logout, selectLoginType } from \"app/adminSlice\";\n\nimport approximateSearch from \"utils/search\";\nimport Search, { renderHoverboxSearch } from \"pages/Header/Search\";\nimport ResponsiveNav from \"components/UI/ResponsiveNav\";\n\n\nconst Header = () => {\n  const dispatch = useAppDispatch();\n  const currentLoginType = useAppSelector(selectLoginType);\n\n  return (\n    <header id={styles.header}>\n      <div id={styles.logoDiv}>\n        <Link to=\"/\" />\n      </div>\n      <Search\n        searchFunction={approximateSearch}\n        renderFunction={renderHoverboxSearch}\n      />\n      <ResponsiveNav id={styles.navbar}>\n        <Link to='/index'>Index</Link>\n        {(\n          currentLoginType !== LoginType.Anonymous &&\n          currentLoginType !== LoginType.NotLoggedIn\n        ) ?\n          (\n            // This is for logged users\n            <>\n              {\n                (currentLoginType === LoginType.Admin) ?\n                  (\n                    <>\n                      <Link to=\"/admin/recycling_bin\">\n                        Recycling Bin\n                      </Link>\n                      <Link to=\"/admin\">\n                        Create New Article\n                      </Link>\n                    </>\n                  ) :\n                  <></>\n              }\n              <button\n                onClick={() => {\n                  dispatch(logout());\n                }}\n              >\n                Logout\n              </button>\n            </>\n          ) :\n          (\n            // not logged in\n            <Link to=\"/account\">Login</Link>\n          )\n        }\n      </ResponsiveNav>\n    </header >\n  );\n};\n\nexport default Header;\n","import styles from \"./Footer.module.scss\";\nimport { SocialIcon } from \"react-social-icons\";\nimport Button from \"components/UI/Button\";\n\n\nfunction Footer() {\n  const socialIcoColor = \"hsl(146, 41%, 60%)\";\n\n  return (\n    <div id={styles.footer}>\n      <div id={styles.content}>\n        <section id={styles.links}>\n          <div id={styles.socialLinks}>\n            <SocialIcon bgColor={socialIcoColor} url=\"https://www.instagram.com/projectenv/\" />\n            <SocialIcon bgColor={socialIcoColor} url=\"https://twitter.com/projectenv\" />\n            <SocialIcon bgColor={socialIcoColor} url=\"https://medium.com/the-environment-project\" />\n            <SocialIcon bgColor={socialIcoColor} url=\"https://www.facebook.com/projectenv\" />\n            <SocialIcon bgColor={socialIcoColor} url=\"https://www.linkedin.com/company/projectenv/\" />\n            <SocialIcon bgColor={socialIcoColor} url=\"https://www.snapchat.com/add/theenvproject/\" />\n          </div>\n          <div id={styles.pageLinks}>\n            <a target=\"_blank\" rel=\"noreferrer\" href=\"https://www.projectenv.org/\">\n              <Button>\n                Homepage\n              </Button>\n            </a>\n            <a target=\"_blank\" rel=\"noreferrer\" href=\"https://secure.givelively.org/donate/hackplus/the-environment-project\">\n              <Button>\n                Donate\n              </Button>\n            </a>\n          </div>\n        </section>\n        <section id={styles.about}>\n          <p>\n            Founded by a group of NYC students in 2020, the Environment Project is a youth-led non-partisan, non-profit organization dedicated to empowering the next generation of climate activists and leaders through digital advocacy and grassroots efforts.\n\n            The Environment Project is fiscally sponsored by Youth Leadership Incubator dba HackPlus, a 501(c)(3) nonprofit organization. All donations are fully tax-deductible.\n          </p>\n          <p>\n             {new Date().getFullYear()} The Environment Project\n          </p>\n        </section>\n      </div>\n    </div>\n  );\n}\n\nexport default Footer;\n","import styles from \"pages/Homepage/Homepage.module.scss\";\nimport { Link } from \"react-router-dom\";\n\nimport { useAppSelector } from \"app/hooks\";\nimport { ArticlesDataProperties, selectNameOfFeaturedArticle, Article } from \"app/articlesSlice\";\n\nimport { validPageLink, randomElt } from \"utils/functions\";\n\nimport Banner from \"components/Article/Banner\";\nimport MarkdownRender from \"components/Article/MarkdownRender\";\n\n\ninterface ArticlePreviewProperties {\n  previewTitle: string,\n  article: Article | undefined | null,\n}\n\nfunction ArticlePreview({ previewTitle, article }: ArticlePreviewProperties) {\n  if (article) {\n    return (\n      <>\n        <Link to={validPageLink(article.name)}>\n          <h2>{previewTitle}</h2>\n        </Link>\n\n        <div className={styles.articleDisplay}>\n          <h2>{article.name}</h2>\n          {(article?.bannerImage) && (\n            <Banner bannerImage={article.bannerImage}></Banner>\n          )}\n          <MarkdownRender className={styles.searchResult}>\n            {`${article.content.substr(0, 800).replaceAll(/(@@.*)|(@@.*@@)/g, \"\")}`}\n          </MarkdownRender>\n        </div>\n      </>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nfunction ArticleShowcase({\n  articlesData: { articles }\n}: ArticlesDataProperties\n) {\n  const randomArticle = (articles.length)\n    ? randomElt(articles)\n    : { name: \"no article name\", content: \"no articles\" };\n\n  const featuredArticleName = useAppSelector(selectNameOfFeaturedArticle);\n  const featuredArticle = articles.find((element) => element.name === featuredArticleName);\n\n  return (\n    <>\n      <ArticlePreview previewTitle=\"Featured Article\" article={featuredArticle} />\n      <ArticlePreview previewTitle=\"Random Article\" article={randomArticle} />\n    </>\n  );\n}\n\nfunction Homepage({ articlesData }: ArticlesDataProperties) {\n  return (\n    <div id={styles.homepage}>\n      <h1>Welcome to Recyclopedia</h1>\n      <p>\n        Recyclopedia is a freely accessible wiki designed to be a complete source for\n        environmentally friendly actions. While it is primarily meant to be a comprehensive\n        source of ways to recycle items appropriately. It may also contain other methods of\n        sustaining an environmentally friendly lifestyle.\n      </p>\n      <p>\n        This is developed by <a href=\"https://www.projectenv.org/\">The Environment Project</a>\n      </p>\n      <ArticleShowcase articlesData={articlesData} />\n    </div>\n  );\n}\n\nexport default Homepage;","import styles from \"App.module.scss\";\nimport { lazy, Suspense, useEffect } from \"react\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\n\nimport { useAppDispatch, useAppSelector } from \"app/hooks\";\nimport { initApi, selectStatus, readArticlesFromLoginType } from \"app/articlesSlice\";\nimport { selectLoginType, LoginType } from \"app/adminSlice\";\n\nimport { Secrets } from \"secrets\";\nimport { validPageLink } from \"utils/functions\";\n\nimport Spinner from \"components/UI/Spinner\";\n\nimport Header from \"pages/Header/Header\";\nimport Footer from \"pages/Footer/Footer\";\nimport Homepage from \"pages/Homepage/Homepage\";\n\nconst Article = lazy(() => import(\"components/Article/Article\"));\nconst IndexPage = lazy(() => import(\"pages/Index/IndexPage\"));\nconst RecyclingBin = lazy(() => import(\"pages/RecyclingBin/RecyclingBin\"));\nconst Admin = lazy(() => import(\"pages/Admin/Admin\"));\nconst Account = lazy(() => import(\"pages/Admin/Account\"));\n\nfunction App() {\n  const currentLoginType = useAppSelector(selectLoginType);\n  const articlesData = readArticlesFromLoginType();\n\n  return (\n    <>\n      <Header />\n\n      <main id={styles.main}>\n        <Switch>\n          <Route exact path='/'>\n            <Homepage articlesData={articlesData} />\n          </Route>\n\n          <Suspense fallback={\n            <p>Please wait! Loading Recyclopedia...</p>\n          }>\n            <Route exact path='/index'>\n              <IndexPage />\n            </Route>\n            <Route path=\"/account\">\n              <Account />\n            </Route>\n\n            <Route exact path='/admin'>\n              {\n                (currentLoginType === LoginType.Admin)\n                  ? <Admin currentArticle={undefined} />\n                  : <Redirect to='/' />\n              }\n            </Route>\n            <Route exact path='/admin/recycling_bin/'>\n              <RecyclingBin />\n            </Route>\n\n            {(currentLoginType === LoginType.Admin) && (\n              articlesData.recycledArticles.map((article) =>\n                <Route key={article.name} exact path={\"/admin/recycling_bin\" + validPageLink(article.name)}>\n                  <Article inRecycling={true} article={article} />\n                </Route>\n              )\n            )}\n\n            {articlesData.articles.map((article) =>\n              <Route key={article.name} exact path={validPageLink(article.name)}>\n                <Article inRecycling={false} article={article} />\n              </Route>\n            )}\n          </Suspense>\n\n          <Route path='*'>404</Route>\n        </Switch>\n      </main>\n\n      <Footer />\n    </>\n  );\n}\n\nfunction InitializingApp() {\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(initApi(Secrets.RECYCLOPEDIA_APPLICATION_ID));\n  }, [dispatch]);\n\n  const status = useAppSelector(selectStatus);\n\n  if (status === \"failed\")\n    return (\n      <div id={styles.errorScreen} >\n        <div className={styles.errorImg} />\n        <p>MongoDB is probably offline. Crap...</p>\n      </div>\n    );\n\n  if (status === \"succeed\")\n    return <App />;\n\n  return (\n    <div id={styles.loadingScreen} >\n      <Spinner color=\"black\" />\n      <p>Please wait! Loading Recyclopedia...</p>\n    </div>\n  );\n}\n\nexport default InitializingApp;\n\n\n/*\n  For obvious reasons getting ALL the articles is kind of dumb. I believe it\n  would be better if we fetched articles on the 404 path.\n\n  Basically we don't generate the routes here. Rather we kind of hook them up on demand.\n\n  So the index is still generated with links, and only as much as we need to display a page.\n\n  Basically that means I have to do something like:\n\n  bucketSize  = the amount of things we consider to be on a \"page\"\n  bucketIndex = the \"page\"\n  getArticleInformationPageful(bucketSize: number, bucketIndex: number);\n\n  IE:\n  It's like:\n  getAllArticles().slice(bucketIndex * bucketSize, (bucketIndex+1) * bucketSize);\n  but since it's on the server side, it reduces the load to send all of them.\n\n  Then in the wildcard route we simply try to make the article component request the article\n  in the URL. If it can't do it, then we just display normal 404.\n\n  We only have 1 million free api requests from MongoDB so this might ironically be worse since\n  each article will take a request from the API (even though it uses less storage space on the\n  client side).\n */\n","import \"index.scss\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter } from \"react-router-dom\";\n\nimport { PersistGate } from \"redux-persist/integration/react\";\nimport { Provider } from \"react-redux\";\nimport { store, persistor } from \"app/store\";\n\nimport App from \"App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <PersistGate persistor={persistor}>\n        <BrowserRouter basename='/recyclopedia'>\n          <App />\n        </BrowserRouter>\n      </PersistGate>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);","import { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\nimport type { RootState, AppDispatch } from \"./store\";\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import { useEffect } from \"react\";\nimport { NodeType } from \"utils/DOMIntoMarkdown\";\nimport { Secrets } from \"secrets\";\n\nexport const validPageLink = (originalName: string) => `/${originalName.toLowerCase().trim().replace(/ +/g, \"_\")}`;\n\nexport async function uploadImage(image_name: string) {\n  const form_data = new FormData();\n  form_data.append(\"image\", image_name);\n\n  const expirationValue = 600;\n  const requestUrl = `https://api.imgbb.com/1/upload?expiration${expirationValue}&key=${Secrets.IMGBB_KEY}`;\n  console.log(requestUrl);\n  const res = await fetch(requestUrl, { method: \"POST\", body: form_data, });\n  console.log(\"waiting...\");\n\n  return await res.json();\n}\n\n// for now this is an alias.\ntype Base64String = string;\ntype RetrievedImageCallback = (f: Base64String) => void;\nexport async function retrieveImageData(\n  imageFile: File,\n  whenRetrieved: RetrievedImageCallback\n) {\n  const image_file = imageFile;\n  const img = document.createElement(\"img\");\n  img.src = URL.createObjectURL(image_file);\n  console.log(\"attempting to load: \", image_file);\n  img.onload = async function () {\n    const canvas = document.createElement(\"canvas\");\n    const canvas_context = canvas.getContext(\"2d\");\n    if (canvas_context) {\n      canvas.width = img.width;\n      canvas.height = img.height;\n\n      canvas_context.drawImage(img, 0, 0);\n      const imgData = canvas.toDataURL().split(\",\")[1];\n      console.log(\"image data retrieved\");\n      whenRetrieved(imgData);\n    } else {\n      console.log(\"null canvas?\");\n    }\n  };\n}\n\n/*\n  These functions are legitimately supposed to be any. These are supposed to operate indiscriminately\n  on any type of dictionary like object.\n\n  Javascript allows you to use anything as a key technically for dictionaries,\n  but this is as close I can get to that I suppose...\n */\n\nexport function dictionaryUpdateKey(\n  dictionary: { [key: string]: any; },\n  key: any,\n  updateFunction: (f: unknown) => unknown\n) {\n  const newDictionary = { ...dictionary };\n  newDictionary[key] = updateFunction(dictionary[key]);\n  return newDictionary;\n}\n\nexport function dictionaryUpdateKeyNested(\n  dictionary: { [key: string]: any; },\n  keys: any[],\n  updateFunction: (f: unknown) => unknown\n) {\n  if (keys.length > 1) {\n    const shallowClone = { ...dictionary };\n    shallowClone[keys[0]] =\n      dictionaryUpdateKeyNested(shallowClone[keys[0]], keys.slice(1), updateFunction);\n    return shallowClone;\n  }\n\n  // returns\n  return dictionaryUpdateKey(dictionary, keys[0], updateFunction);\n}\n\nexport const useTimeout = (callback: () => void, delay: number) => {\n  useEffect(() => {\n    const timer = setTimeout(() => callback(), delay);\n    return () => clearTimeout(timer);\n  }, [delay, callback]);\n};\n\nexport function randomElt(array: any[]) {\n  return array[Math.floor(Math.random() * array.length)];\n}\n\n// dom helps?\nexport function classListClear(node: Element) {\n  while (node.classList.length > 0) {\n    node.classList.remove(node.classList.item(0) || \"\");\n  }\n}\n\nexport function classListReplace(node: Element, classes: string[]) {\n  classListClear(node);\n  console.log(node.classList);\n  for (const classItem of classes) {\n    node.classList.add(classItem);\n  }\n  console.log(node.classList);\n}\n\n// http://w3c.github.io/html-reference/syntax.html\nconst voidElementTagNameTable = [\n  \"BR\", \"BASE\", \"AREA\", \"COL\", \"COMMAND\",\n  \"EMBED\", \"HR\", \"IMG\", \"INPUT\", \"KEYGEN\",\n  \"LINK\", \"META\", \"PARAM\", \"SOURCE\", \"TRACK\", \"WBR\"\n];\n\nexport function isVoidElement(root: Node) {\n  if (root.nodeType === NodeType.Element) {\n    const elementRoot = root as Element;\n\n    for (const elementName of voidElementTagNameTable) {\n      if (elementRoot.tagName === elementName) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// push and pop the current selection stack\n// this is mostly to keep the selection consistent for stuff...\n// that needs to temporarily break focus or whatever...\nconst _selectionStack: Range[] = [];\nexport function selectionStackPush() {\n  const selection = window.getSelection();\n  const topMostSelection = selection?.getRangeAt(0);\n\n  if (topMostSelection) {\n    selection?.removeRange(topMostSelection);\n    _selectionStack.push(topMostSelection);\n  }\n}\n\nexport function selectionStackPop() {\n  if (_selectionStack.length) {\n    const selection = window.getSelection();\n    selection?.addRange(_selectionStack.pop() as Range);\n  }\n}\n\nfunction isDevelopment() {\n  if (process.env.NODE_ENV || process.env.NODE_ENV === \"development\") {\n    return true;\n  }\n\n  return false;\n}\n\n/*\n  This thing is just useful for having messages that don't show up in production\n  and also allow for more noticable TODOs because probably no one reads comments, but\n  I assure you that we will read the console.\n\n  Although in practice we may only just use General/Warning/Error as just console wrappers\n  to avoid spamming in the console.\n*/\nexport enum MessageLogType {\n  General,\n  Warning,\n  Error,\n  Todo,\n  Note,\n}\n\nexport function logMessage(type: MessageLogType, message?: any, ...optionalParams: any[]) {\n  if (isDevelopment()) {\n    let messageFn = console.log;\n    const argumentsList = [];\n    let composedMessage = \"\";\n\n    switch (type) {\n    case MessageLogType.Todo:\n    case MessageLogType.Note:\n    case MessageLogType.General:\n      if (type === MessageLogType.Todo) {\n        composedMessage += \"%cTODO%c\";\n        argumentsList.push(\"background-color: black; color: orange; font-size: 1.2em;\", \"unset: all;\");\n      } else if (type === MessageLogType.Note) {\n        composedMessage += \"%cNOTE:%c\";\n        argumentsList.push(\"background-color: black; color: lightgreen; font-size: 1.2em;\", \"unset: all;\");\n      } else {\n        composedMessage += \"%cINFO: %c\";\n        argumentsList.push(\"background-color: black; color: white; font-size: 1.2em;\", \"unset: all;\");\n      }\n      messageFn = console.log;\n      break;\n    case MessageLogType.Warning:\n      composedMessage += \"%cWARNING%c\";\n      argumentsList.push(\"background-color: black; color: white; font-size: 1.2em;\", \"unset: all;\");\n      messageFn = console.warn;\n      break;\n    case MessageLogType.Error:\n      messageFn = console.error;\n      composedMessage += \"%cERROR!%c\";\n      argumentsList.push(\"background-color: black; color: red; font-size: 1.2em;\", \"unset: all;\");\n      break;\n    }\n\n    composedMessage += (message || \"\");\n    for (const element of optionalParams) {\n      argumentsList.push(element);\n    }\n\n    messageFn(composedMessage, argumentsList);\n  }\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav\":\"ResponsiveNav_nav__zeHnk\",\"sidebar\":\"ResponsiveNav_sidebar__3v_Sl\",\"overlay\":\"ResponsiveNav_overlay__1IidR\",\"shrunk\":\"ResponsiveNav_shrunk__2OMOW\",\"opened\":\"ResponsiveNav_opened__3QRzf\",\"slideIn\":\"ResponsiveNav_slideIn__2CQLm\",\"slideOut\":\"ResponsiveNav_slideOut__3HVvW\",\"menuBtn\":\"ResponsiveNav_menuBtn__1D92N\",\"closeBtn\":\"ResponsiveNav_closeBtn__3ZebB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"articleControls\":\"Article_articleControls__95Evd\",\"title\":\"Article_title__G_BGG\",\"dateView\":\"Article_dateView__3UGVs\",\"article\":\"Article_article__3AVYo\",\"floatCenter\":\"Article_floatCenter__1RUh-\",\"floatLeft\":\"Article_floatLeft__2IJ3p\",\"floatRight\":\"Article_floatRight__3pqbI\",\"noWrapAroundText\":\"Article_noWrapAroundText__2dudq\",\"captionBox\":\"Article_captionBox__1tZ2s\",\"captionImagePreview\":\"Article_captionImagePreview__3saqr\",\"captionBoxInner\":\"Article_captionBoxInner__ZRS_C\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchbar\":\"Searchbar_searchbar__2jLRV\",\"focused\":\"Searchbar_focused__39Jjj\",\"searchbarControl\":\"Searchbar_searchbarControl__3mGMh\",\"clear\":\"Searchbar_clear__3uANO\",\"search\":\"Searchbar_search__1ch6H\",\"searchResults\":\"Searchbar_searchResults__18l6O\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"footer\":\"Footer_footer__3THvQ\",\"content\":\"Footer_content__3ozSR\",\"links\":\"Footer_links__HVJTZ\",\"socialLinks\":\"Footer_socialLinks__12n0J\",\"pageLinks\":\"Footer_pageLinks__3wK3K\",\"about\":\"Footer_about__1YIEu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loadingScreen\":\"App_loadingScreen__J9ldS\",\"errorScreen\":\"App_errorScreen__3OgjQ\",\"errorImg\":\"App_errorImg__3nX-t\",\"main\":\"App_main__2Jffb\"};","/*\n  Store context sensitive information here\n */\nexport const Secrets = {\n  RECYCLOPEDIA_APPLICATION_ID: \"recyclopedia-api-uuuus\",\n  ADMIN_PASSWORD: \"tonyisugly\",\n  IMGBB_KEY: \"5eba0537206ecc76b4a505e866868853\"\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__2fJbI\",\"logoDiv\":\"Header_logoDiv__1Hf0g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__1_sNH\",\"default\":\"Button_default__1hCTa\",\"oval\":\"Button_oval__Z1YBF\",\"oval-danger\":\"Button_oval-danger__6JnTk\",\"circle\":\"Button_circle__z4HHN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"homepage\":\"Homepage_homepage__2XFyl\",\"articleDisplay\":\"Homepage_articleDisplay__33qDe\"};","import styles from \"./Button.module.scss\";\nimport cn from \"classnames\";\n\n\nfunction Button({\n  children,\n  type = \"button\",\n  styledAs,\n  className,\n  ...props\n}: {\n  children: React.ReactNode;\n  styledAs?: \"oval\" | \"oval-danger\" | \"circle\";\n} & React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement>\n) {\n  return (\n    <button\n      className={cn(\n        styles.button,\n        styledAs ? styles[styledAs] : styles.default,\n        className\n      )}\n      type={type}\n      {...props}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default Button;\n","import { createSlice, createDraftSafeSelector, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { RootState } from \"app/store\";\n\nimport { Credentials } from \"realm-web\";\nimport { databaseApi } from \"app/articlesSlice\";\n\nexport enum LoginType {\n  NotLoggedIn,\n  Anonymous,\n  User,\n  Admin,\n}\n\nexport interface AccountDetails {\n  email: string;\n  password: string;\n}\n\nexport interface LoginAttemptResult {\n  type: LoginType,\n  accountDetails?: AccountDetails,\n}\n\ninterface ApplicationState {\n  loginType: LoginType | null,\n  accountDetails: AccountDetails,\n  // I will make this an any for now to avoid having\n  // to type it.\n  accountCustomData: any,\n}\n\nconst initialState: ApplicationState = {\n  loginType: LoginType.NotLoggedIn,\n  accountDetails: {\n    email: \"\",\n    // we should probably not be storing this\n    // well... actually it's clientside, so it's probably fine...\n    password: \"\",\n  },\n  accountCustomData: {\n\n  }\n};\n\nexport async function registerAccount(information: AccountDetails) {\n  await databaseApi.application?.emailPasswordAuth.registerUser(information.email, information.password);\n}\n\nexport async function loginWith(information?: AccountDetails) {\n  const credentials = (!information)\n    ? Credentials.anonymous()\n    : Credentials.emailPassword(information.email, information.password);\n\n  let user = undefined;\n  try {\n    user = await databaseApi.application?.logIn(credentials);\n    return { type: LoginType.User, user };\n  } catch (error) {\n    user = await databaseApi.application?.logIn(Credentials.anonymous());\n    return { type: LoginType.Anonymous, user };\n  } finally {\n    databaseApi.applicationUser = user;\n  }\n}\n\nexport const loginWithEmailAndPassword = createAsyncThunk(\n  \"admin/loginWithEmailAndPassword\",\n  async (accountDetails: AccountDetails) => {\n    const { type, user } = await loginWith(accountDetails);\n\n    if (type !== LoginType.Anonymous) {\n      const possiblyAdminLoginType =\n        (user?.customData.status) === \"admin\" ? LoginType.Admin : false;\n      return {\n        accountDetails,\n        type: possiblyAdminLoginType || type,\n        customData: user?.customData,\n      };\n    }\n\n    return { type };\n  }\n);\n\nconst adminSlice = createSlice({\n  name: \"admin\",\n  initialState,\n  reducers: {\n    logout: (state) => {\n      state.loginType = LoginType.NotLoggedIn;\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(\n      loginWithEmailAndPassword.fulfilled,\n      (state, action) => {\n        const payload = action.payload;\n\n        switch (payload.type) {\n        case LoginType.User:\n        case LoginType.Admin:\n          state.accountDetails = payload.accountDetails;\n          state.loginType = payload.type;\n          state.accountCustomData = payload.customData;\n          break;\n\n        default: break;\n        }\n      }\n    );\n  }\n});\n\nexport const {\n  logout\n} = adminSlice.actions;\nexport default adminSlice.reducer;\n\nconst selectSelf = (state: RootState) => state.admin;\n\nexport const selectLoginType = createDraftSafeSelector(\n  selectSelf,\n  (admin) => admin.loginType\n);\n\nexport const selectAccountDetails = createDraftSafeSelector(\n  selectSelf,\n  (admin) => admin.accountDetails\n);\n\n// This should be more specifically typed\n// however this isn't finalized so let's not do that.\nexport const selectAccountCustomData = createDraftSafeSelector(\n  selectSelf,\n  (admin) => admin.accountCustomData\n);","import MD from \"markdown-it\";\nconst md = MD({\n  html: true,\n  breaks: true,\n  linkify: true,\n  typographer: true,\n});\n\nexport const renderMarkdown = (text: string) => md.render(text);\n\nfunction MarkdownRender({\n  className, children\n}: {\n  className: string; children: string;\n}) {\n  return (\n    <div\n      className={className}\n      dangerouslySetInnerHTML={{ __html: renderMarkdown(children) }}>\n    </div>\n  );\n}\n\nexport default MarkdownRender;","/*\n    Inhouse DOM to Markdown interpreter.\n\n    This is primarily designed to take the DOM Soup from contenteditable\n    on firefox.\n\n    It'll probably work good enough with a properly formed DOM, but don't blame\n    me if something explodes.\n*/\nimport articleStyles from \"components/Article/Article.module.scss\";\n\nfunction surrounder(sym: string) {\n  return function (content: typeof sym) {\n    let spacesLeft = 0;\n    let spacesRight = 0;\n    for (let i = 0; i < content.length; ++i) {\n      if (content[i] !== \" \") {\n        spacesLeft = i - 1;\n        break;\n      }\n    }\n    for (let i = content.length - 1; i > 0; --i) {\n      if (content[i] !== \" \") {\n        break;\n      }\n      spacesRight++;\n    }\n    return `${spacesLeft > 0 ? \" \".repeat(spacesLeft) : \"\"}${sym}${content.trim()}${sym}${spacesRight > 0 ? \" \".repeat(spacesRight) : \"\"}`;\n  };\n}\n\nconst surrounders = {\n  \"B\": surrounder(\"**\"),\n  \"STRONG\": surrounder(\"**\"),\n  \"I\": surrounder(\"_\"),\n  \"EM\": surrounder(\"_\"),\n  \"U\": surrounder(\"__\"),\n};\n// @ts-ignore\nconst safe_call = (fn) => (...rest) => (fn) ? fn(...rest) : rest[0];\n/*\nNOTE(jerry):\n\nI'm not a particular fan of this since this is definitely very scrappy. It does not know how to\nproperly handle nested lists, although without extra modification the RichTextEditor doesn't allow you\nto do nested lists trivially anyways... So hopefully it's not much of a disaster (just store the current indent\nlevel and then do it based off of whatever markdown seems to recognize a list as.)\n\nMost other normal elements are handled fine, it's really just the lists I'm concerned about.\n\nThis is entirely recursive, and because it's recursive it loses some information that may be useful for\ncleaner and probably easier rendering...\n*/\n\nexport enum NodeType {\n  Element = 1,\n  Attribute = 2,\n  Text = 3,\n  CDataSection = 4,\n  ProcessingInformation = 5,\n  Comment = 6,\n  Document = 7,\n  DocumentType = 8,\n  DocumentFragment = 9,\n}\n\n// we're going to use divs as semantic types.\nenum DivSemanticType {\n  Unknown,\n  CaptionedImage,\n  Article\n}\n\nfunction determineSemanticTypeOfDivElement(root: HTMLDivElement): DivSemanticType {\n  const classList = root.classList;\n\n  if (root.classList.contains(articleStyles.captionBox)) {\n    return DivSemanticType.CaptionedImage;\n  } else if (root.classList.contains(articleStyles.article)) {\n    return DivSemanticType.Article;\n  }\n\n  return DivSemanticType.Unknown;\n}\n\nfunction renderDivElementIntoMarkdown(root: HTMLDivElement): string {\n  const semanticType = determineSemanticTypeOfDivElement(root);\n  console.log(semanticType);\n\n  switch (semanticType) {\n  case DivSemanticType.CaptionedImage: {\n    const imageElement = root.children[0] as HTMLImageElement;\n    const captionTextElement = root.children[1] as HTMLDivElement;\n    const captionTextContents = captionTextElement.children[0] as HTMLParagraphElement;\n\n    let rendered_string = \"\";\n    rendered_string += `src = '${imageElement.src}' |` ;\n    rendered_string += `width = ${imageElement.width} |` ;\n    rendered_string += `height = ${imageElement.height} |` ;\n    rendered_string += `caption = '${captionTextContents.textContent?.trim()}'`;\n\n    if (root.classList.contains(articleStyles.floatLeft)) {\n      rendered_string += \"| floatingMethod = floatLeft\";\n    } else if (root.classList.contains(articleStyles.floatCenter)) {\n      rendered_string += \"| floatingMethod = floatCenter\";\n    } else if (root.classList.contains(articleStyles.floatRight)) {\n      rendered_string += \"| floatingMethod = floatRight\";\n    }\n\n    return \"@@ \" + rendered_string + \" @@\";\n  } break;\n\n  case DivSemanticType.Article: {\n    return renderChildrenOfDomAsMarkdown(root);\n  } break;\n\n  case DivSemanticType.Unknown:\n  default:\n    console.error(\"This is unusual... Unknown Div structure?\");\n    return \"\";\n  }\n}\n\nfunction renderChildrenOfDomAsMarkdown(root: HTMLElement): string {\n  let result = \"\";\n\n  for (const child of Array.from(root.childNodes)) {\n    const asHTMLElementChild = child as HTMLElement;\n\n    result += renderElementAsMarkdown(asHTMLElementChild);\n  }\n\n  return result;\n}\n\nfunction renderElementAsMarkdown(root: HTMLElement): string {\n  if (root.nodeType === NodeType.Text) {\n    return (root.textContent || \"\");\n  }\n\n  switch (root.tagName) {\n  case \"DIV\": {\n    return renderDivElementIntoMarkdown(root as HTMLDivElement); \n  } break;\n\n  /*\n  TODO(jerry):\n  I do not attempt to parse additional decoration here.\n  */\n  case \"A\": {\n    const anchorElement = root as HTMLAnchorElement;\n    const anchorText = anchorElement.textContent; \n    const anchorLink = anchorElement.href;\n\n    return `[${anchorText}](${anchorLink})`;\n  } break;\n\n  case \"IMG\": {\n    const imageElement = root as HTMLImageElement; \n\n    let rendered_string = \"\";\n    rendered_string += `src = '${imageElement.src}' |` ;\n    rendered_string += `width = ${imageElement.width} |` ;\n    rendered_string += `height = ${imageElement.height}` ;\n\n    if (imageElement.classList.contains(articleStyles.floatLeft)) {\n      rendered_string += \"| floatingMethod = floatLeft\";\n    } else if (imageElement.classList.contains(articleStyles.floatCenter)) {\n      rendered_string += \"| floatingMethod = floatCenter\";\n    } else if (imageElement.classList.contains(articleStyles.floatRight)) {\n      rendered_string += \"| floatingMethod = floatRight\";\n    }\n\n    return \"@@ \" + rendered_string + \" @@\\n\";\n  } break;\n\n  case \"H6\": case \"H5\": case \"H4\": case \"H3\": case \"H2\": case \"H1\": {\n    const headerElement = root as HTMLHeadingElement;\n    return \"\\n\" + \"#\".repeat(Number(root.tagName[1])) + \" \" + renderChildrenOfDomAsMarkdown(root) + \"\\n\";\n  } break;\n\n  case \"B\": case \"U\": case \"I\": case \"STRONG\": case \"EM\": {\n    const inbetween = renderChildrenOfDomAsMarkdown(root);\n    console.log(\"TWEEN\", inbetween);\n    if (inbetween !== \"\") {\n      return safe_call(surrounders[root.tagName])(inbetween);\n    }\n\n    // return \"<p><br/></p>\";\n  } break;\n\n  case \"OL\": {\n    const childrenNodes = Array.from(root.childNodes);\n    let result = \"\";\n\n    let i = 1;\n    for (const child of childrenNodes) {\n      if (child.nodeType === NodeType.Element) {\n        result += `${i++}. ` + renderChildrenOfDomAsMarkdown(child as HTMLElement) + \"\\n\";\n      }\n    }\n\n    return result+\"\\n\";\n  } break;\n\n  case \"UL\": {\n    const childrenNodes = Array.from(root.childNodes);\n    let result = \"\";\n\n    for (const child of childrenNodes) {\n      if (child.nodeType === NodeType.Element) {\n        result += \"- \" + renderChildrenOfDomAsMarkdown(child as HTMLElement) + \"\\n\";\n      }\n    }\n\n    return result+\"\\n\";\n  } break;\n\n  /*\n  ALERT(jerry):\n\n  This seems to be the most problematic element as it can never convert 1-1 from anything we give it... Most elements will parent themselves to\n  the paragraph which makes it iffy af.\n\n  IE: The structural that's generated by a contenteditable element... Is really confusing and not easy to figure out... I may have to do way more manual work\n  than I was ever expecting...\n  */\n  case \"P\": {\n    /*\n    NOTE(jerry):\n\n    Why doesn't everyone just agree on what shit should be generated?\n    This has only been tested on Firefox. We'll have to find this out later...\n    */\n    const childrenNodes = Array.from(root.children);\n\n    // As I set the defaultSeparator to use <p>\n    // the only way I can get consistent appearance with the actual article\n    // is to literally just output it... It looks dumb.\n    // This is also not 100% correct... But it may pass inspection.\n    if (childrenNodes.length === 1 && childrenNodes[0].tagName === \"BR\") {\n      return root.outerHTML + \"\\n\";\n    }\n\n    return renderChildrenOfDomAsMarkdown(root) + \"\\n\\n\";\n  } break;\n\n  default: {\n    console.error(\"Unhandled case: \", root.tagName);\n  } break;\n  }\n\n  return \"\";\n}\n\nexport function renderDomAsMarkdown(root: HTMLElement): string {\n  return renderElementAsMarkdown(root);\n}\n","import styles from \"./Banner.module.scss\";\n\n\nfunction Banner({\n  bannerImage\n}: {\n  bannerImage: string;\n}) {\n  return (\n    <div className={styles.bannerContainer}>\n      <img src={bannerImage} />\n    </div>\n  );\n}\n\nexport default Banner;"],"sourceRoot":""}